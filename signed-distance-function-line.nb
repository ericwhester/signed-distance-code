(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    202137,       5498]
NotebookOptionsPosition[    184111,       5233]
NotebookOutlinePosition[    184661,       5253]
CellTagsIndexPosition[    184618,       5250]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Signed distance coordinates for curves", "Title",
 CellChangeTimes->{{3.775439852844901*^9, 3.77543985624973*^9}, {
  3.7856150489041367`*^9, 3.785615050278329*^9}, {3.875785781554818*^9, 
  3.8757857829068203`*^9}, {3.8838822333852262`*^9, 
  3.883882237755225*^9}},ExpressionUUID->"2e1e1f32-b3e7-4f78-8ef1-\
b3e9d5ee5503"],

Cell["\<\
In this notebook we develop differential geometry and code to perform higher \
order asymptotic analysis of boundary layers around evolving curves in space. \
To do so, we follow the procedure outlined in our paper:
1. Derive Frenet-Frame coordinates
2. Derive orthogonal signed distance coordinates based on the Bishop frame
3. Derive spatial vector calculus operators
4. Derive temporal vector calclulus operators
5. Encapsulate these operators in convenient mathematica functions
6. Rescale these operators by \[Epsilon]
7. Express each unknown as a power series in \[Epsilon]
8. Express a PDE as a power series in \[Epsilon]\
\>", "Text",
 CellChangeTimes->{{3.7981443092182827`*^9, 3.798144364169731*^9}, {
  3.7981445020571823`*^9, 3.798144780422398*^9}, {3.79814482182185*^9, 
  3.7981448543738737`*^9}, {3.798144945357126*^9, 3.798145000500745*^9}, {
  3.875785789583902*^9, 3.875785822924974*^9}, {3.8839299146906013`*^9, 
  3.883930051465527*^9}, {3.88393013843143*^9, 
  3.883930139740686*^9}},ExpressionUUID->"a884496d-9ba9-419b-b225-\
2e2beae087b4"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellProlog", ":>", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{
      RowBox[{"NextCell", "[", 
       RowBox[{"CellStyle", "->", "\"\<Input\>\""}], "]"}], ",", "All", ",", 
      "Cell"}], "]"}]}]}], "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b1564d7e-0c6f-4514-a7b7-a94d5622f2bf"],

Cell["\<\
We\[CloseCurlyQuote]re going to keep track of all the arrays (for Jacobians, \
Lame scale coefficients, connection coefficients etc.) in both expanded and \
abbreviated form, as well as the rules needed to expand the latter into the \
former.\
\>", "Text",
 CellChangeTimes->{{3.883939608449902*^9, 
  3.883939671675596*^9}},ExpressionUUID->"921cd982-67cd-48b5-aba2-\
04514cc7ca0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tables", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8805076810158*^9, {3.8839300891731663`*^9, 3.883930108331921*^9}, {
   3.883932128387311*^9, 3.883932135488099*^9}, 3.8839396826486263`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"e42cac10-fd80-4b2d-bece-7a274c954744"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyRules", "[", 
   RowBox[{"exp_", ",", "ruleList_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", "exp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{"out", "//.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "rule", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"rule", ",", "ruleList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "out"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.883945588275012*^9, 3.883945692594376*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"1b693d0f-c872-4f72-aa77-375cef25a26a"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ll also define convenient functions for converting a \
pattern replacement to a function replacement (e.g. the difference between ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "->", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "75ee660c-ffee-4585-b23d-0a27af6845d6"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "->", 
    RowBox[{"(", 
     RowBox[{"1", "&"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e12ff9aa-b10b-4474-87ac-fdefaad366d3"],
 ")."
}], "Text",
 CellChangeTimes->{{3.8839396868965387`*^9, 
  3.883939748226253*^9}},ExpressionUUID->"8bbaf7dc-cb10-4d83-abbe-\
be80520385ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tensorRank", "[", "tensor_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"Head", "[", "tensor", "]"}], "===", "Symbol"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"Head", "[", "tensor", "]"}], "===", "List"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Length", "[", 
     RowBox[{"Dimensions", "[", "tensor", "]"}], "]"}], ",", 
    "\[IndentingNewLine]", "0"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"patternToFunction", "[", "pat_", "]"}], ":=", 
  RowBox[{
   RowBox[{"pat", "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a_", "[", "l___", "]"}], "->", "b_"}], ")"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "->", "b"}], ")"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"List", "[", "l", "]"}], "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Slot", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"List", "[", "l", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}]}]}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a_", "->", "b_"}], ")"}], "->", 
    RowBox[{"(", 
     RowBox[{"a", "->", 
      RowBox[{"(", 
       RowBox[{"b", "&"}], ")"}]}], ")"}], 
    "\[IndentingNewLine]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.8805076810158*^9, {3.8839300891731663`*^9, 3.883930108331921*^9}, {
   3.883932128387311*^9, 3.883932135488099*^9}, 3.8839396826486263`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"bde4fad2-65ff-4d33-8910-a8949966331d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deriving orthogonal coordinates", "Title",
 CellChangeTimes->{{3.8794648800651817`*^9, 3.879464881145051*^9}, {
  3.879466391912407*^9, 3.8794663964749193`*^9}, {3.879468437757553*^9, 
  3.8794684400710907`*^9}, {3.879525654659109*^9, 3.879525655931191*^9}, {
  3.883782503410637*^9, 3.883782515821204*^9}, {3.8837833842844677`*^9, 
  3.8837833896152363`*^9}},ExpressionUUID->"c6f33c08-f43a-488c-afc0-\
18bdd2256c92"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Coordinates", "Chapter"]], "Chapter",
 CellChangeTimes->{{3.8801364683956013`*^9, 
  3.880136469602728*^9}},ExpressionUUID->"6269c5ce-48c0-45fd-a55a-\
c7fb526903d1"],

Cell["Define the signed distance and orthogonal coordinates", "Text",
 CellChangeTimes->{{3.883849478861751*^9, 
  3.883849491596093*^9}},ExpressionUUID->"500e6883-8734-41be-8f22-\
d20ce500f99c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coords", "=", 
   RowBox[{"{", 
    RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"s", ",", "\[Tau]"}], "]"}], "+", 
    RowBox[{"\[Sigma]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "+", 
          RowBox[{"\[CurlyPhi]", "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], 
        RowBox[{
         OverscriptBox["n", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "+", 
          RowBox[{"\[CurlyPhi]", "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], 
        RowBox[{
         OverscriptBox["b", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.872148913517907*^9, 3.872148919499558*^9}, {
   3.872233067784342*^9, 3.872233069527422*^9}, {3.879466141296382*^9, 
   3.879466160506659*^9}, {3.879526232854067*^9, 3.879526234728777*^9}, {
   3.8801375090836687`*^9, 3.8801375130474463`*^9}, {3.880137645496636*^9, 
   3.8801376469349413`*^9}, 3.883783078524125*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"3ff7dbd8-24ef-4905-bea4-058fa7b9ec34"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basis vectors", "Chapter",
 CellChangeTimes->{{3.880136474341158*^9, 
  3.8801364763101873`*^9}},ExpressionUUID->"2b6356ef-76e1-45cc-b357-\
03aaa7b73a9d"],

Cell["\<\
Define the Frenet-Serret frame, and the rotated orthonormal signed distance \
coordinate frame\
\>", "Text",
 CellChangeTimes->{{3.883849496716588*^9, 
  3.8838495231538477`*^9}},ExpressionUUID->"841a0af2-0e20-409e-b897-\
1d16fede48da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        OverscriptBox["t", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], ",", 
       RowBox[{
        OverscriptBox["n", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], ",", 
       RowBox[{
        OverscriptBox["b", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        OverscriptBox["ts", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], ",", 
       RowBox[{
        OverscriptBox["t\[Sigma]", "^"], "[", 
        RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], ",", 
       RowBox[{
        OverscriptBox["t\[Theta]", "^"], "[", 
        RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<frames\>\"", "]"}], "]"}], "=", "frames"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.872156958307694*^9, 3.8721569760705233`*^9}, {
  3.879554099718089*^9, 3.879554133651243*^9}, {3.8801363619763193`*^9, 
  3.880136363645322*^9}, {3.880137562071671*^9, 3.880137571094656*^9}, {
  3.880137695502883*^9, 3.880137698567602*^9}, {3.8839321735615387`*^9, 
  3.8839321769570103`*^9}, {3.8839397608382463`*^9, 3.88393976906642*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a3ad1c98-e6e2-48e0-adec-865f848aae31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frenet Derivatives", "Chapter",
 CellChangeTimes->{{3.88013647899949*^9, 3.880136480182972*^9}, {
  3.8801394114557753`*^9, 
  3.8801394296192913`*^9}},ExpressionUUID->"7fd2c975-f77b-40af-a0d4-\
92de0965e0d6"],

Cell["\<\
Define the derivatives of the Frenet-Serret frame, the arclength derivative.\
\>", "Text",
 CellChangeTimes->{{3.883849527989565*^9, 
  3.883849563420479*^9}},ExpressionUUID->"46a027d7-762c-43fe-acef-\
a274d6b2908a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dp\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"p", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{
        RowBox[{"vt", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], 
        RowBox[{
         OverscriptBox["t", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"vn", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], 
        RowBox[{
         OverscriptBox["n", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"vb", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], 
        RowBox[{
         OverscriptBox["b", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "s"], 
       RowBox[{"p", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{
        OverscriptBox["t", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], 
       RowBox[{"h", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883943634566126*^9, 3.883943673742838*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"f96b18d6-ab82-4ec4-a8c7-26d7a438f19b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds", "[", "x_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "s"], "x"}], 
   RowBox[{"h", "[", 
    RowBox[{"s", ",", "\[Tau]"}], "]"}]]}]], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"5b53aba6-0f6d-4b81-ac7c-c244c0aa5570"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<f12p\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        OverscriptBox["t", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", 
       RowBox[{"ds", "[", 
        RowBox[{"p", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        OverscriptBox["n", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", 
       FractionBox[
        RowBox[{"ds", "[", 
         RowBox[{
          OverscriptBox["t", "^"], "[", 
          RowBox[{"s", ",", "\[Tau]"}], "]"}], "]"}], 
        RowBox[{"\[Kappa]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        OverscriptBox["b", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", 
       RowBox[{
        RowBox[{
         OverscriptBox["t", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], "\[Cross]", 
        RowBox[{
         OverscriptBox["n", "^"], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}]}], "}"}], "//", 
    "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8721474390478363`*^9, 3.872147593903633*^9}, 
   3.872148552914133*^9, 3.872148725422468*^9, {3.872148765307415*^9, 
   3.872148772451569*^9}, {3.872154645619759*^9, 3.872154645747938*^9}, {
   3.87215472038032*^9, 3.8721547205263*^9}, {3.879554150592383*^9, 
   3.8795541561638737`*^9}, {3.87955419590025*^9, 3.879554238900798*^9}, {
   3.879554276583682*^9, 3.8795543037105494`*^9}, {3.879554354902692*^9, 
   3.879554375664241*^9}, {3.879554507766307*^9, 3.8795545143048162`*^9}, 
   3.8795563596304407`*^9, 3.88378308349667*^9, {3.883930231856304*^9, 
   3.8839302902707977`*^9}, {3.883930352535404*^9, 3.883930359325643*^9}, 
   3.8839398114038067`*^9, 3.8839437204546423`*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"f08d7b06-e801-420b-87b4-d0f9a2770f51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "s"], 
       RowBox[{
        OverscriptBox["t", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Kappa]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], 
       RowBox[{
        OverscriptBox["n", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], 
       RowBox[{"h", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "s"], 
       RowBox[{
        OverscriptBox["n", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}], 
          RowBox[{
           OverscriptBox["t", "^"], "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"\[Omega]", "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}], 
          RowBox[{
           OverscriptBox["b", "^"], "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}], 
       RowBox[{"h", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "s"], 
       RowBox[{
        OverscriptBox["b", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Omega]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], 
       RowBox[{
        OverscriptBox["n", "^"], "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], 
       RowBox[{"h", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "s"], 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "/.", 
       RowBox[{"rules", "[", 
        RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", "frame1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{"s", ",", "2"}], "}"}]], 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "//.", 
       RowBox[{"rules", "[", 
        RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "//", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"#", ",", "frame1"}], "]"}], "&"}]}]}], "]"}]}], 
  ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.8721474390478363`*^9, 3.872147593903633*^9}, 
   3.872148552914133*^9, 3.872148725422468*^9, {3.872148765307415*^9, 
   3.872148772451569*^9}, {3.872154645619759*^9, 3.872154645747938*^9}, {
   3.87215472038032*^9, 3.8721547205263*^9}, {3.879554150592383*^9, 
   3.8795541561638737`*^9}, {3.87955419590025*^9, 3.879554238900798*^9}, {
   3.879554276583682*^9, 3.8795543037105494`*^9}, {3.879554354902692*^9, 
   3.879554375664241*^9}, {3.879554507766307*^9, 3.8795545143048162`*^9}, 
   3.8795563596304407`*^9, 3.88378308349667*^9, {3.883930231856304*^9, 
   3.8839302902707977`*^9}, {3.883930352535404*^9, 3.883930359325643*^9}, 
   3.8839398114038067`*^9, {3.883943498269701*^9, 3.883943504966181*^9}, 
   3.883943566763464*^9, 3.883943705290372*^9, {3.8839437612598343`*^9, 
   3.8839437698266153`*^9}},ExpressionUUID->"fca8fb55-8e14-4fc3-af60-\
3ba6c659aef8"],

Cell["Define the Frenet-Frame in terms of more primitive objects", "Text",
 CellChangeTimes->{{3.8839398145514507`*^9, 
  3.883939845791945*^9}},ExpressionUUID->"b3a390bd-2aa4-40ea-969c-\
4b0157fedf56"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial gradient", "Chapter",
 CellChangeTimes->{{3.880136564728898*^9, 
  3.880136566536503*^9}},ExpressionUUID->"4c7f5fb7-af9a-46f4-b145-\
9337f1a72fd3"],

Cell["Calculate the gradient from signed distance coordinates", "Text",
 CellChangeTimes->{{3.88384957302251*^9, 3.883849582280167*^9}, {
   3.883849614378031*^9, 3.883849660267346*^9}, 
   3.883849716846302*^9},ExpressionUUID->"e1e5d8aa-2419-4722-a7b0-\
e5dc74c27468"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dsxf1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"x", "@@", "coords"}], ",", 
       RowBox[{"coords", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "Simplify"}], "]"}], "&"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.883849719486754*^9}, 3.883930294452529*^9, {
   3.8839305077954903`*^9, 3.8839305108990192`*^9}, {3.883932186736947*^9, 
   3.883932203731223*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"315e1377-ff8a-41fd-b184-eaf76c259028"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dsxf1\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dsxf1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{"frames", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "&"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.883849719486754*^9}, 3.883930294452529*^9, {
   3.8839305077954903`*^9, 3.8839305108990192`*^9}, {3.883932186736947*^9, 
   3.883932203731223*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"df00b410-401a-48da-beb9-657da3eaf177"],

Cell["Derive the rotation required for orthogonality", "Text",
 CellChangeTimes->{{3.8838497209526854`*^9, 
  3.883849726886801*^9}},ExpressionUUID->"757dcede-47cf-491f-b6c0-\
2cabe7342f77"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<dsxf1\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j"}], "]"}], "]"}], "==", "0"}], ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", "s"], 
         RowBox[{"\[CurlyPhi]", "[", 
          RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.88384973146035*^9}, {3.8839305186939783`*^9, 
   3.883930535610137*^9}, 3.88393225984303*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"3ca1363d-a6dc-4a71-931f-6172309ce470"],

Cell["\<\
Define transformations between the Frenet-Serret and Orthogonal frames\
\>", "Text",
 CellChangeTimes->{{3.883849732710135*^9, 3.883849746458721*^9}, {
  3.8839305738374453`*^9, 
  3.883930578901918*^9}},ExpressionUUID->"7498a912-4632-412a-a82b-\
71242dc462e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"twoToThree", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"surfToVol", "[", "m_", "]"}], ":=", 
  RowBox[{"twoToThree", ".", "m", ".", 
   RowBox[{"twoToThree", "\[Transpose]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<f12f2\>\"", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"surfToVol", "[", 
     RowBox[{"rot", "[", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[CurlyPhi]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], "\[TensorProduct]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"id", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"id", ",", 
       RowBox[{"tables", "[", 
        RowBox[{"[", "\"\<f12f2\>\"", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<f12f2\>\"", "]"}], "]"}], "\[Transpose]"}], ",", 
       "id"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"frames", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], ".", 
         RowBox[{"frames", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", "patternToFunction"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.88384973146035*^9}, {3.883930744362763*^9, 
   3.8839307745017443`*^9}, {3.8839323332806396`*^9, 
   3.8839324098007107`*^9}, {3.883939874270808*^9, 3.883939907037589*^9}, {
   3.883939996650915*^9, 3.8839400041144743`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"06a0c9e6-13e5-45da-98cb-196f3e5132e6"],

Cell["\<\
Define cross products of vectors in each frame, and define rules to implement \
bilinear algebra of binary operators on frame vectors\
\>", "Text",
 CellChangeTimes->{{3.883849750741754*^9, 
  3.883849784858162*^9}},ExpressionUUID->"a1ad2279-450c-44be-a395-\
e6115b58f3a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eps", "=", 
   RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<crosses\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[Cross]", 
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "->", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "k", ",", "l"}], "]"}], "]"}], 
          RowBox[{"frames", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "l"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "3"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dots\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], ".", 
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "->", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"j", ",", "k"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"bilinear", "[", "o_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"b_", "+", "c_"}]}], "]"}], "->", 
     RowBox[{
      RowBox[{"o", "[", 
       RowBox[{"a", ",", "b"}], "]"}], "+", 
      RowBox[{"o", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{
       RowBox[{"a_", "+", "b_"}], ",", "c_"}], "]"}], "->", 
     RowBox[{
      RowBox[{"o", "[", 
       RowBox[{"a", ",", "c"}], "]"}], "+", 
      RowBox[{"o", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"f", ",", "OverHat"}], "]"}]}], ")"}], "a_"}], ")"}], ",",
        "b_"}], "]"}], "->", 
     RowBox[{"f", " ", 
      RowBox[{"o", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"o", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f_", "/;", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"f", ",", "OverHat"}], "]"}]}], ")"}], "b_"}], ")"}]}], 
      "]"}], "->", 
     RowBox[{"f", " ", 
      RowBox[{"o", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<bilinear\>\"", "]"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"bilinear", "[", "Cross", "]"}], ",", 
     RowBox[{"bilinear", "[", "Dot", "]"}], ",", 
     RowBox[{"bilinear", "[", "TensorProduct", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.8838497134586563`*^9}, 3.883930621667568*^9, 
   3.883930808087435*^9, {3.883930897933573*^9, 3.883930927096521*^9}, {
   3.883931796132842*^9, 3.883931844018471*^9}, 3.88393207050803*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"c61beff9-6eea-4669-a076-c44ed77f6454"],

Cell["Calculate the scale factors", "Text",
 CellChangeTimes->{{3.8839400254286947`*^9, 
  3.883940028635399*^9}},ExpressionUUID->"b2d61aa7-bc9f-4728-a2fe-\
91f7d8b9fb6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dsxf2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dsxf1", "/.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872149184122813*^9, 3.87214919647571*^9}, {
   3.872149230805316*^9, 3.872149239547824*^9}, {3.8721492756666813`*^9, 
   3.872149280827695*^9}, {3.8721495313791656`*^9, 3.872149534233159*^9}, 
   3.87215476035077*^9, {3.8721548014181957`*^9, 3.872154803439712*^9}, {
   3.8795545490200977`*^9, 3.879554568753561*^9}, {3.879555963949791*^9, 
   3.8795559640726357`*^9}, {3.880136055685601*^9, 3.880136065391966*^9}, {
   3.8801361706805553`*^9, 3.880136183086583*^9}, {3.8801365196799603`*^9, 
   3.88013652396842*^9}, {3.8801366080308313`*^9, 3.880136614040827*^9}, {
   3.880139296601272*^9, 3.8801393081335773`*^9}, 3.8837830904605827`*^9, {
   3.88384967122178*^9, 3.8838497134586563`*^9}, 3.883930621667568*^9, 
   3.883930808087435*^9, {3.883930897933573*^9, 3.883930927096521*^9}, {
   3.883930994599271*^9, 3.883931001393611*^9}, 3.883931033653636*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"59a5b122-039c-42d5-8aa3-2a2e672aadd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<h\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dsxf2", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", 
         RowBox[{"frames", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "//.", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<bilinear\>\"", "]"}], "]"}]}], "/.", 
       RowBox[{"rules", "[", 
        RowBox[{"[", "\"\<dots\>\"", "]"}], "]"}]}], "//", "Simplify"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<h0\>\"", "]"}], "]"}], "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"hs", "[", 
       RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
      ",", "1", ",", 
      RowBox[{"h\[Theta]", "[", "\[Sigma]", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<h0E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"hs", "[", 
        RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}],
        "->", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Sigma]", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "+", 
             RowBox[{"\[CurlyPhi]", "[", 
              RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], " ", 
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"h\[Theta]", "[", "\[Sigma]", "]"}], "->", "\[Sigma]"}]}], 
     "}"}], "//", "patternToFunction"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883932479484522*^9, 3.883932497532495*^9}, {
   3.883932618920755*^9, 3.8839326859881687`*^9}, {3.883932730609565*^9, 
   3.883932738892105*^9}, {3.883932852307138*^9, 3.883932856022732*^9}, {
   3.8839376946372347`*^9, 3.88393773083541*^9}, {3.883940034503635*^9, 
   3.8839400386634083`*^9}, 3.883945488160551*^9, 3.883946243910898*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"b9e70ac2-370f-4717-97cd-f85166dbf6f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frame spatial derivatives", "Chapter",
 CellChangeTimes->{{3.880154973453269*^9, 
  3.880154977522242*^9}},ExpressionUUID->"427a00a2-eac3-4f8e-8123-\
f78d72220999"],

Cell["Calculate the derivatives of the frame vectors", "Text",
 CellChangeTimes->{{3.88384979818451*^9, 
  3.8838498070397987`*^9}},ExpressionUUID->"204bd57c-d5c8-44dc-bff2-\
6b8fdeedf456"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dsf2F\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["\[PartialD]", 
             RowBox[{"coords", "[", 
              RowBox[{"[", "j", "]"}], "]"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"frames", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}], "/.", 
              RowBox[{
               RowBox[{"rules", "[", 
                RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
           RowBox[{"rules", "[", 
            RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{"rules", "[", 
            RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}]}], "//", "Simplify"}], 
       ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.880154979414942*^9, 3.880155136613949*^9}, {
   3.8801562417651987`*^9, 3.880156249266816*^9}, {3.883783105090274*^9, 
   3.8837831065282383`*^9}, {3.8839302996394157`*^9, 
   3.8839303021691933`*^9}, {3.883930810739625*^9, 3.8839308134521027`*^9}, 
   3.883931488474842*^9, {3.883932930651423*^9, 3.883932939591721*^9}, 
   3.883932972488618*^9, {3.883940063771*^9, 3.883940121777135*^9}, 
   3.883940177244116*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"5cfb8c2d-2c36-494f-b10c-432b47a0b70e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf2F\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}]], 
          RowBox[{"frames", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "->", 
         RowBox[{
          RowBox[{
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<dsf2F\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], ".", 
          RowBox[{"frames", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], "]"}], "&"}]}], 
       "]"}], "&"}]}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883940259355839*^9, 3.883940361793165*^9}, {
  3.8839404250546427`*^9, 3.8839404576172132`*^9}, {3.883940635495977*^9, 
  3.88394070814813*^9}, {3.8839407732204027`*^9, 3.883940800336135*^9}, {
  3.8839408950608664`*^9, 3.883941041073043*^9}, {3.8839410824402943`*^9, 
  3.883941083765903*^9}, {3.883941177753909*^9, 3.883941256704033*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"d4e1eeda-6239-4485-b48c-64d458304537"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dsf20\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"AA", "[", 
          RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], ",", 
         RowBox[{"BB", "[", 
          RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"AA", "[", 
           RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], ",", "0", 
         ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"BB", "[", 
           RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], ",", "0", 
         ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883946844072472*^9, 3.8839469240975637`*^9}, {
  3.8839469603510427`*^9, 3.8839469847152233`*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"6cca8fa2-6a1e-4a0c-8d83-c6226d1f75b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf20\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}]], 
          RowBox[{"frames", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "->", 
         RowBox[{
          RowBox[{
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<dsf20\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "i"}], "]"}], "]"}], ".", 
          RowBox[{"frames", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], "]"}], "&"}]}], 
       "]"}], "&"}]}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883947364501412*^9, 3.883947367960515*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"24177bbd-64fc-435a-a089-1511e56d2e9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dsf20E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lhs", ",", "rhs"}], "}"}], ",", 
        RowBox[{"lhs", "->", "rhs"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"table", "[", 
         RowBox[{"[", 
          RowBox[{"Sequence", "@@", "index"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"table", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<dsf20\>\"", "]"}], "]"}], ",", 
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<dsf2F\>\"", "]"}], "]"}]}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], 
       "]"}]}], "]"}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88394699655868*^9, 3.883947000232169*^9}, {
  3.883947047907278*^9, 3.883947055655694*^9}, {3.883947099880348*^9, 
  3.883947138646346*^9}, {3.88394719523829*^9, 3.883947207647087*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"0aaeaf19-fc69-4ff4-ae89-6c573540f7c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frame time derivatives", "Chapter",
 CellChangeTimes->{{3.8801381777338743`*^9, 3.8801381798320713`*^9}, {
  3.880139439435739*^9, 3.880139440481728*^9}, {3.880155283816546*^9, 
  3.880155284142747*^9}},ExpressionUUID->"7fb3a3fb-beaa-4833-a64a-\
d29f91aadada"],

Cell["\<\
Calculate time derivatives of the Frenet-Serret frame vectors\
\>", "Text",
 CellChangeTimes->{{3.883849875396598*^9, 3.8838498807568607`*^9}, {
  3.883849925554191*^9, 
  3.883849928130836*^9}},ExpressionUUID->"64065052-95d1-49a7-b2f2-\
a4df5a36ff66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d\[Tau]f1F", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Tau]"], 
           RowBox[{"frames", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "//.", 
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<f12p\>\"", "]"}], "]"}]}], "//.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<dsf1\>\"", "]"}], "]"}]}], "//.", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<bilinear\>\"", "]"}], "]"}]}], "//.", 
       RowBox[{"rules", "[", 
        RowBox[{"[", "\"\<crosses\>\"", "]"}], "]"}]}], ")"}], "//", 
     "Thread"}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "#", "]"}], "]"}], "&"}]}], "]"}], 
     "&"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1F\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"d\[Tau]f1F", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8795561731656103`*^9, 3.8795562781337023`*^9}, {
   3.879556314680081*^9, 3.879556336712879*^9}, {3.879556372473695*^9, 
   3.87955637342274*^9}, 3.8798870600986147`*^9, {3.880136588993088*^9, 
   3.880136599408381*^9}, {3.88013823073534*^9, 3.880138241102212*^9}, {
   3.880138481270543*^9, 3.8801385267422647`*^9}, {3.880139007807208*^9, 
   3.88013901785891*^9}, {3.8801394505602503`*^9, 3.880139451252964*^9}, {
   3.880140862422768*^9, 3.880140869221389*^9}, {3.880142210736137*^9, 
   3.880142216890429*^9}, 3.8837831423456697`*^9, 3.883930306144122*^9, 
   3.883931066449987*^9, {3.883931718957424*^9, 3.883931719494454*^9}, {
   3.883931760911825*^9, 3.883931766024515*^9}, {3.8839318214851923`*^9, 
   3.88393184337776*^9}, 3.883932049581975*^9, {3.883933071323941*^9, 
   3.883933160937454*^9}, {3.883933424366478*^9, 3.8839334470493183`*^9}, 
   3.883933498467945*^9, {3.883933608302071*^9, 3.883933621558137*^9}, {
   3.883933663502738*^9, 3.8839336804367523`*^9}, 3.883933712330015*^9, 
   3.883934424251968*^9, {3.883934476632661*^9, 3.883934476761198*^9}, {
   3.883941406617263*^9, 3.883941430362549*^9}, 3.883941487077999*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"fa076125-35d3-4430-a42f-9f27e3141410"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]h\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f1F\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       SuperscriptBox["h", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]\[Kappa]\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Kappa]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"tables", "[", 
               RowBox[{"[", "\"\<d\[Tau]f1F\>\"", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
             RowBox[{"2", 
              RowBox[{
               RowBox[{"tables", "[", 
                RowBox[{"[", "\"\<d\[Tau]f1F\>\"", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], "//", 
          "Simplify"}], "//", "Expand"}], ")"}], "==", "0"}], ",", 
      RowBox[{
       SuperscriptBox["\[Kappa]", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8795561731656103`*^9, 3.8795562781337023`*^9}, {
   3.879556314680081*^9, 3.879556336712879*^9}, {3.879556372473695*^9, 
   3.87955637342274*^9}, 3.8798870600986147`*^9, {3.880136588993088*^9, 
   3.880136599408381*^9}, {3.88013823073534*^9, 3.880138241102212*^9}, {
   3.880138481270543*^9, 3.8801385267422647`*^9}, {3.880139007807208*^9, 
   3.88013901785891*^9}, {3.8801394505602503`*^9, 3.880139451252964*^9}, {
   3.880140862422768*^9, 3.880140869221389*^9}, {3.880142210736137*^9, 
   3.880142216890429*^9}, 3.8837831423456697`*^9, 3.883930306144122*^9, 
   3.883931066449987*^9, {3.883931718957424*^9, 3.883931719494454*^9}, {
   3.883931760911825*^9, 3.883931766024515*^9}, {3.8839318214851923`*^9, 
   3.88393184337776*^9}, 3.883932049581975*^9, {3.883933071323941*^9, 
   3.883933160937454*^9}, {3.883933424366478*^9, 3.8839334470493183`*^9}, 
   3.883933498467945*^9, {3.883933608302071*^9, 3.883933621558137*^9}, {
   3.883933663502738*^9, 3.8839336804367523`*^9}, 3.883933712330015*^9, 
   3.883934424251968*^9, {3.883934476632661*^9, 3.883934476761198*^9}, 
   3.883941406617263*^9, {3.883941438648156*^9, 3.883941442554202*^9}, {
   3.883941480087967*^9, 3.883941509426056*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"de2ee178-3320-4a07-9e8a-e5a07a187453"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f1F\>\"", "]"}], "]"}], "//.", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<d\[Tau]h\>\"", "]"}], "]"}]}], "//.", 
       RowBox[{
        SubscriptBox["\[PartialD]", "s"], 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<d\[Tau]h\>\"", "]"}], "]"}]}]}], "//.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<d\[Tau]\[Kappa]\>\"", "]"}], "]"}]}], "//.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8795561731656103`*^9, 3.8795562781337023`*^9}, {
   3.879556314680081*^9, 3.879556336712879*^9}, {3.879556372473695*^9, 
   3.87955637342274*^9}, 3.8798870600986147`*^9, {3.880136588993088*^9, 
   3.880136599408381*^9}, {3.88013823073534*^9, 3.880138241102212*^9}, {
   3.880138481270543*^9, 3.8801385267422647`*^9}, {3.880139007807208*^9, 
   3.88013901785891*^9}, {3.8801394505602503`*^9, 3.880139451252964*^9}, {
   3.880140862422768*^9, 3.880140869221389*^9}, {3.880142210736137*^9, 
   3.880142216890429*^9}, 3.8837831423456697`*^9, 3.883930306144122*^9, 
   3.883931066449987*^9, {3.883931718957424*^9, 3.883931719494454*^9}, {
   3.883931760911825*^9, 3.883931766024515*^9}, {3.8839318214851923`*^9, 
   3.88393184337776*^9}, 3.883932049581975*^9, {3.883933071323941*^9, 
   3.883933160937454*^9}, {3.883933424366478*^9, 3.8839334470493183`*^9}, 
   3.883933498467945*^9, {3.883933608302071*^9, 3.883933621558137*^9}, {
   3.883933663502738*^9, 3.8839336804367523`*^9}, 3.883933712330015*^9, 
   3.883934424251968*^9, {3.883934476632661*^9, 3.883934476761198*^9}, 
   3.883941406617263*^9, {3.883941438648156*^9, 3.883941442554202*^9}, {
   3.883941480087967*^9, 3.883941557166881*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"5582647b-a66a-4c1b-a0b8-28d3072105e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"tables", "[", 
        RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], ".", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "//", "Thread"}], "//", 
    "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8795561731656103`*^9, 3.8795562781337023`*^9}, {
   3.879556314680081*^9, 3.879556336712879*^9}, {3.879556372473695*^9, 
   3.87955637342274*^9}, 3.8798870600986147`*^9, {3.880136588993088*^9, 
   3.880136599408381*^9}, {3.88013823073534*^9, 3.880138241102212*^9}, {
   3.880138481270543*^9, 3.8801385267422647`*^9}, {3.880139007807208*^9, 
   3.88013901785891*^9}, {3.8801394505602503`*^9, 3.880139451252964*^9}, {
   3.880140862422768*^9, 3.880140869221389*^9}, {3.880142210736137*^9, 
   3.880142216890429*^9}, 3.8837831423456697`*^9, 3.883930306144122*^9, 
   3.883931066449987*^9, {3.883931718957424*^9, 3.883931719494454*^9}, {
   3.883931760911825*^9, 3.883931766024515*^9}, {3.8839318214851923`*^9, 
   3.88393184337776*^9}, 3.883932049581975*^9, {3.883933071323941*^9, 
   3.883933160937454*^9}, {3.883933424366478*^9, 3.8839334470493183`*^9}, 
   3.883933498467945*^9, {3.883933608302071*^9, 3.883933621558137*^9}, {
   3.883933663502738*^9, 3.8839336804367523`*^9}, 3.883933712330015*^9, 
   3.883934424251968*^9, {3.883934476632661*^9, 3.883934476761198*^9}, 
   3.883941406617263*^9, {3.883941438648156*^9, 3.883941442554202*^9}, {
   3.883941480087967*^9, 3.88394153186998*^9}, 3.8839415673922977`*^9, {
   3.883941745300619*^9, 3.883941746590726*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"019cc045-f1fa-4ed4-89fa-e02a692396f9"],

Cell["Abbreviated form", "Text",
 CellChangeTimes->{{3.88393441796084*^9, 
  3.883934419923675*^9}},ExpressionUUID->"3bd68f2d-f219-46ce-b4e6-\
fef2e25ef988"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], ",", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Alpha]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], ",", "0", ",", 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Beta]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"tables", "[", 
        RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}], ".", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "//", "Thread"}], "//", 
    "patternToFunction"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883933915506089*^9, 3.883933928375331*^9}, {
   3.883933960152017*^9, 3.883933966065819*^9}, {3.883934128662274*^9, 
   3.883934129360114*^9}, {3.883934320411044*^9, 3.883934344975623*^9}, 
   3.8839344089906807`*^9, {3.883937752831429*^9, 3.883937757347991*^9}, 
   3.883937849914875*^9, {3.8839386630523443`*^9, 3.883938663135581*^9}, {
   3.8839391790207787`*^9, 3.8839391853869133`*^9}, 3.88394179945652*^9},
 CellLabel->
  "In[114]:=",ExpressionUUID->"b9526347-554b-4df5-9d75-3c9cb0f51047"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f10E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lhs", ",", "rhs"}], "}"}], ",", 
        RowBox[{"lhs", "->", "rhs"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"table", "[", 
         RowBox[{"[", 
          RowBox[{"Sequence", "@@", "index"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"table", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}], ",", 
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}]}], "}"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883933915506089*^9, 3.883933928375331*^9}, {
   3.883933960152017*^9, 3.883933966065819*^9}, {3.883934128662274*^9, 
   3.883934129360114*^9}, {3.883934320411044*^9, 3.883934344975623*^9}, 
   3.8839344089906807`*^9, {3.883937752831429*^9, 3.883937757347991*^9}, 
   3.883937849914875*^9, {3.8839386630523443`*^9, 3.883938663135581*^9}, {
   3.8839391790207787`*^9, 3.8839391853869133`*^9}, 3.88394179945652*^9, {
   3.883941881999936*^9, 3.8839418886343317`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"2108156a-a0e1-4978-b406-af6474f34d45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"frames", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "//.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}]}], "//.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f10E\>\"", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Tau]"], 
      RowBox[{"frames", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "//.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.883937656980379*^9, 3.8839376613060617`*^9}, {
  3.883939193727057*^9, 3.883939240295608*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"a569aa6b-4321-4732-b124-3ecd22eb1176"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.880140898536398*^9, 3.880140934065782*^9}, {
  3.880596785962338*^9, 3.880596789080449*^9}, {3.883933088684826*^9, 
  3.883933088687401*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"3105fc13-e4c6-4c97-bdb5-2719f2a443be"],

Cell["\<\
Calculate time derivatives of the orthonormal coordinate frame (both in \
expanded and condensed form)\
\>", "Text",
 CellChangeTimes->{{3.883849930773435*^9, 3.883849938529467*^9}, {
  3.883939439599366*^9, 
  3.88393944762103*^9}},ExpressionUUID->"9daf41dc-4a03-49c9-b493-\
3bc06772e92d"],

Cell[BoxData[
 RowBox[{"rules", "[", 
  RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.883943446421545*^9, 3.88394345242799*^9}},
 CellLabel->"",ExpressionUUID->"d4bd1942-9410-4238-b305-a0736e8f6cdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Tau]f2F", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "Simplify"}], "]"}], "&"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8801389204838*^9, 3.88013893215961*^9}, {
   3.8801390213425407`*^9, 3.880139022202195*^9}, {3.88013944765629*^9, 
   3.880139448349374*^9}, 3.880141303703849*^9, {3.880141691084324*^9, 
   3.8801417119446383`*^9}, {3.88014245030615*^9, 3.880142481699946*^9}, 
   3.883783156963704*^9, {3.8839308147015333`*^9, 3.883930815558313*^9}, {
   3.883933088689354*^9, 3.883933128032374*^9}, 3.8839331589217777`*^9, {
   3.8839332291472883`*^9, 3.883933320860776*^9}, {3.883934538026894*^9, 
   3.883934551595173*^9}, {3.8839392757691383`*^9, 3.883939276607897*^9}, {
   3.883939316136056*^9, 3.883939366855138*^9}, {3.883939437711419*^9, 
   3.883939451800761*^9}, {3.883941898457464*^9, 3.883941906780201*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"d5b4d673-4df3-449b-be59-8eb16a72b7e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Tau]f2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Tau]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"frames", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"rules", "[", 
       RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "Simplify"}], "]"}], "&"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8801389204838*^9, 3.88013893215961*^9}, {
   3.8801390213425407`*^9, 3.880139022202195*^9}, {3.88013944765629*^9, 
   3.880139448349374*^9}, 3.880141303703849*^9, {3.880141691084324*^9, 
   3.8801417119446383`*^9}, {3.88014245030615*^9, 3.880142481699946*^9}, 
   3.883783156963704*^9, {3.8839308147015333`*^9, 3.883930815558313*^9}, {
   3.883933088689354*^9, 3.883933128032374*^9}, 3.8839331589217777`*^9, {
   3.8839332291472883`*^9, 3.883933320860776*^9}, {3.883934538026894*^9, 
   3.883934551595173*^9}, {3.8839392757691383`*^9, 3.883939276607897*^9}, {
   3.883939316136056*^9, 3.883939366855138*^9}, {3.883939437711419*^9, 
   3.883939451800761*^9}, {3.883941898457464*^9, 3.883941912271575*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"0dbe8738-8dc8-4ae6-b2ff-3c089e2d6514"],

Cell["Fully expanded", "Text",
 CellChangeTimes->{{3.883941986047935*^9, 
  3.883941987938336*^9}},ExpressionUUID->"9448e175-daab-4d31-8857-\
ba58d74e87da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f2F\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"d\[Tau]f2F", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"frames", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", "\[IndentingNewLine]",
       "Simplify"}], ")"}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"\[CurlyPhi]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"\[CurlyPhi]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
     "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8801389204838*^9, 3.88013893215961*^9}, {
   3.8801390213425407`*^9, 3.880139022202195*^9}, {3.88013944765629*^9, 
   3.880139448349374*^9}, 3.880141303703849*^9, {3.880141691084324*^9, 
   3.8801417119446383`*^9}, {3.88014245030615*^9, 3.880142481699946*^9}, 
   3.883783156963704*^9, {3.8839308147015333`*^9, 3.883930815558313*^9}, {
   3.883933088689354*^9, 3.883933128032374*^9}, 3.8839331589217777`*^9, {
   3.8839332291472883`*^9, 3.883933320860776*^9}, 3.883934538026894*^9, {
   3.883934570678244*^9, 3.883934617181036*^9}, {3.883937189889105*^9, 
   3.883937201404949*^9}, {3.8839395142036953`*^9, 3.883939521850285*^9}, {
   3.8839419196541433`*^9, 3.8839419366045723`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"0d9fd189-3341-40e4-ae8c-3e4723a33684"],

Cell["One step of expansion", "Text",
 CellChangeTimes->{{3.8839419898189096`*^9, 
  3.883941993398528*^9}},ExpressionUUID->"6f5c1dab-f0a6-41cd-a3aa-\
a8c91ae41b68"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f2\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"d\[Tau]f2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"frames", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", "\[IndentingNewLine]",
       "Simplify"}], ")"}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"\[CurlyPhi]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "+", 
           RowBox[{"\[CurlyPhi]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
     "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883941981332756*^9, 3.8839419828120327`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"180ea80d-a070-4180-96a2-ad871fc32ecc"],

Cell["Fully abbreviated", "Text",
 CellChangeTimes->{{3.8839419960058737`*^9, 
  3.883941998983712*^9}},ExpressionUUID->"76489500-e9b6-4a9d-9ead-\
09821a4223bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"\[Alpha]2", "@@", "coords"}], ",", 
       RowBox[{"\[Beta]2", "@@", "coords"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Alpha]2", "@@", "coords"}]}], ",", "0", ",", 
       RowBox[{"\[Gamma]2", "@@", "coords"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Beta]2", "@@", "coords"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"\[Gamma]2", "@@", "coords"}]}], ",", "0"}], "}"}]}], "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f20E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lhs", ",", "rhs"}], "}"}], ",", 
        RowBox[{"lhs", "->", "rhs"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"table", "[", 
         RowBox[{"[", 
          RowBox[{"Sequence", "@@", "index"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"table", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}], ",", 
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<d\[Tau]f2\>\"", "]"}], "]"}]}], "}"}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}], "//", "patternToFunction"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f2F\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Tau]"], 
        RowBox[{"frames", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "->", "d\[Tau]f2F"}], ")"}], "//", 
     "Thread"}], "//", "patternToFunction"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f2\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Tau]"], 
        RowBox[{"frames", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "->", "d\[Tau]f2"}], ")"}], "//", 
     "Thread"}], "//", "patternToFunction"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Tau]"], 
        RowBox[{"frames", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "->", 
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}], ".", 
        RowBox[{"frames", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "//", "Thread"}], "//", 
    "patternToFunction"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883937297231408*^9, 3.883937301410891*^9}, {
   3.8839373437636633`*^9, 3.883937343950666*^9}, 3.883942436003481*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"7430f6de-8cec-4397-a3de-bbca8d61196d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<\[Gamma]\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Omega]", "[", 
          RowBox[{"s", ",", "\[Tau]"}], "]"}], 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "s"], 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}], ")"}]}], 
         RowBox[{"h", "[", 
          RowBox[{"s", ",", "\[Tau]"}], "]"}]]}], ")"}], 
      RowBox[{"\[Kappa]", "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}]]}], "//", "patternToFunction"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8801389204838*^9, 3.88013893215961*^9}, {
   3.8801390213425407`*^9, 3.880139022202195*^9}, {3.88013944765629*^9, 
   3.880139448349374*^9}, 3.880141303703849*^9, {3.880141691084324*^9, 
   3.8801417119446383`*^9}, {3.88014245030615*^9, 3.880142481699946*^9}, 
   3.883783156963704*^9, {3.8839308147015333`*^9, 3.883930815558313*^9}, {
   3.883933088689354*^9, 3.883933128032374*^9}, 3.8839331589217777`*^9, {
   3.8839332291472883`*^9, 3.8839332807153273`*^9}, {3.883942460990817*^9, 
   3.883942479100576*^9}, 3.883942512292087*^9, {3.883942656371399*^9, 
   3.8839426602711897`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"1da01659-a405-441c-9d77-18af4541a128"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], "/.", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<\[Gamma]\>\"", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
    RowBox[{"rules", "[", 
     RowBox[{"[", "\"\<d\[Tau]f10E\>\"", "]"}], "]"}]}], "//", "Simplify"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883942602649387*^9, 3.883942638345745*^9}, 
   3.883942668349127*^9},
 CellLabel->
  "In[171]:=",ExpressionUUID->"605a9bcd-560f-473f-93c4-b1504696e2c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coordinate time derivatives", "Chapter",
 CellChangeTimes->{{3.880142171773882*^9, 
  3.880142174485167*^9}},ExpressionUUID->"1ee5698f-2e77-4c22-a8ce-\
46cd6b6414d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"x2", "[", 
    RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"s", ",", "\[Tau]"}], "]"}], "+", 
    RowBox[{"\[Sigma]", " ", 
     RowBox[{
      OverscriptBox["t\[Sigma]", "^"], "[", 
      RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883943028320779*^9, 3.8839430923060226`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"5ea1a969-b3c2-4ec7-88e1-407f51bf47c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<vf22f1\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v\[Sigma]", "[", 
         RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], ",", 
        RowBox[{"v\[Theta]", "[", 
         RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], "}"}], "->", 
      
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", "\[Tau]"], 
               RowBox[{"p", "[", 
                RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "/.", 
              RowBox[{"rules", "[", 
               RowBox[{"[", "\"\<dp\>\"", "]"}], "]"}]}], ")"}], ".", 
            RowBox[{"frames", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "//.", 
           RowBox[{
            RowBox[{"rules", "[", 
             RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "//.", 
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<bilinear\>\"", "]"}], "]"}]}], "//.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<dots\>\"", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "//", 
     "Thread"}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883944359876587*^9, 3.883944523524891*^9}, {
  3.883945722296795*^9, 3.8839457236129103`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"7a3fb462-3184-461e-9778-8701492179fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<vf12f2\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vn", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}], ",", 
        RowBox[{"vb", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "}"}], "->", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"v\[Sigma]", "[", 
               RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], ",", 
              RowBox[{"v\[Theta]", "[", 
               RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], "}"}], 
            ".", 
            RowBox[{"frames", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ".", 
            RowBox[{"frames", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "/.", 
           RowBox[{
            RowBox[{"rules", "[", 
             RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//.", 
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<bilinear\>\"", "]"}], "]"}]}], "//.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<dots\>\"", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "//", 
     "Thread"}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883944664237213*^9, 3.883944827835113*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"71fca987-9a53-49d2-ae4a-7c1a21312ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Tau]xf2F", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Tau]"], 
          RowBox[{"x2", "@@", "coords"}]}], "/.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<dp\>\"", "]"}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}], ")"}], 
     "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f2F\>\"", "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883944118020893*^9, 3.883944133043516*^9}, 
   3.883944211994331*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"7e6504b9-6e54-477e-a4fd-053d038a69e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Tau]xf2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Tau]"], 
          RowBox[{"x2", "@@", "coords"}]}], "/.", 
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<dp\>\"", "]"}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{"rules", "[", 
          RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}], ")"}], 
     "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f2\>\"", "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883944236446929*^9, 3.8839442391679983`*^9}, 
   3.8839443235477457`*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"af1e362d-e8b7-47cc-a621-f661846519ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Tau]xf20", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Tau]"], 
           RowBox[{"x2", "@@", "coords"}]}], "/.", 
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<dp\>\"", "]"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<fi2fj\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/.", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<vf12f2\>\"", "]"}], "]"}]}], "//", "Simplify"}], 
      ")"}], "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88394393757946*^9, 3.8839439596211977`*^9}, {
  3.883944090477765*^9, 3.883944110496076*^9}, {3.883944325470883*^9, 
  3.883944327178245*^9}, {3.883944869990823*^9, 3.883944901230918*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"29f25e11-4194-444b-bbff-cf6ae070f74c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dts", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "T"], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"c", "@@", 
        RowBox[{"{", 
         RowBox[{"T", ",", "X", ",", "Y", ",", "Z"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "coords"}], "}"}]}], "]"}]}], "/.", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Tau]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"T", ",", "X", ",", "Y", ",", "Z"}], "]"}], "->", "1"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.880143154751706*^9, 3.880143227502132*^9}, {
   3.88015375453577*^9, 3.880153758333107*^9}, 3.883783249528367*^9, 
   3.883944967836719*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"9809e05b-d06a-43cd-b99b-32639d331c8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtssolsF", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"dts", ".", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tables", "[", 
                RowBox[{"[", "\"\<h\>\"", "]"}], "]"}], ".", 
               RowBox[{
                RowBox[{"tables", "[", 
                 RowBox[{"[", "\"\<frames\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"{", "d\[Tau]xf2F", "}"}]}], "]"}]}], ",", 
           RowBox[{"frames", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], "==", "0"}], ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", "T"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "@@", 
           RowBox[{"{", 
            RowBox[{"T", ",", "X", ",", "Y", ",", "Z"}], "}"}]}], ")"}]}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883945432135172*^9, 3.883945432505114*^9}, {
  3.883945532606204*^9, 3.883945546338909*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"8d6c6301-201f-4f6f-9cfa-b1421746738d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtssols0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"dts", ".", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tables", "[", 
                RowBox[{"[", "\"\<h0\>\"", "]"}], "]"}], ".", 
               RowBox[{
                RowBox[{"tables", "[", 
                 RowBox[{"[", "\"\<frames\>\"", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"{", "d\[Tau]xf20", "}"}]}], "]"}]}], ",", 
           RowBox[{"frames", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], "==", "0"}], ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", "T"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "@@", 
           RowBox[{"{", 
            RowBox[{"T", ",", "X", ",", "Y", ",", "Z"}], "}"}]}], ")"}]}]}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.880143154751706*^9, 3.880143227502132*^9}, {
   3.88015375453577*^9, 3.880153758333107*^9}, 3.883783249528367*^9, {
   3.883944967836719*^9, 3.883944994787056*^9}, {3.883945377526802*^9, 
   3.883945426707754*^9}, {3.883945515456341*^9, 3.883945529266261*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"cdba57bf-6f6e-427e-bb02-88c1e9a8990a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyRules", "[", 
    RowBox[{
     RowBox[{"dtssols0", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<vf22f1\>\"", ",", "\"\<d\[Tau]f20E\>\"", ",", 
       "\"\<d\[Tau]f10E\>\"", ",", "\"\<h0E\>\""}], "}"}]}], "]"}], "-", 
   RowBox[{"dtssolsF", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.883945675916066*^9, 3.883945707208745*^9}, {
  3.883945738322382*^9, 3.883945805326701*^9}, {3.883945842783252*^9, 
  3.88394584619237*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"507b40ea-8ba7-4dee-a8fc-03a823a32401"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"dtssols0", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dtF\>\"", "]"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"dtssolsF", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883946336826085*^9, 3.883946442584457*^9}, {
  3.8839475539040537`*^9, 3.8839475627676983`*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"6ec864d2-cc5e-4cb3-b467-e6ac8bd0b55a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frame Cartesian time derivatives", "Chapter",
 CellChangeTimes->{{3.880155273536974*^9, 
  3.880155292150106*^9}},ExpressionUUID->"e350c6e0-6fb5-45f8-aea0-\
098c72cfda13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyRules", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"frames", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "coords"}], "]"}], ".", 
      
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<dtF\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<d\[Tau]f2F\>\"", ",", "\"\<dsf2F\>\""}], "}"}]}], "]"}], 
   "-", 
   RowBox[{"applyRules", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"frames", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "coords"}], "]"}], ".", 
      
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<d\[Tau]f20\>\"", ",", "\"\<dsf20\>\"", ",", "\"\<d\[Tau]f20E\>\"", 
       ",", "\"\<d\[Tau]f10E\>\"", ",", "\"\<dsf20E\>\"", ",", 
       "\"\<h0E\>\""}], "}"}]}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.883946653713209*^9, 3.883946654385242*^9}, {
  3.883947283849251*^9, 3.883947304965723*^9}, {3.8839475261473713`*^9, 
  3.883947528848567*^9}, {3.8839475777423897`*^9, 3.883947651538542*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"ef7cc9ba-da24-485a-bf31-9b1785706e92"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dtf2\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"applyRules", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{
             RowBox[{"frames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "coords"}], "]"}], ".", 
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<d\[Tau]f20\>\"", ",", "\"\<dsf20\>\""}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883947942992051*^9, 3.8839480025896873`*^9}, 
   3.883948299162672*^9},
 CellLabel->
  "In[350]:=",ExpressionUUID->"74778e71-c08a-4411-a091-74b33c6bead5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dtf20\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"a", "@@", "coords"}], ",", 
       RowBox[{"b", "@@", "coords"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "@@", "coords"}]}], ",", "0", ",", 
       RowBox[{"c", "@@", "coords"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"b", "@@", "coords"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"c", "@@", "coords"}]}], ",", "0"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883948304694099*^9, 3.883948354102921*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"600d9ddd-876b-4dbd-866f-182576bfe4c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dtf2F\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"applyRules", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Grad", "[", 
            RowBox[{
             RowBox[{"frames", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "coords"}], "]"}], ".", 
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<dtF\>\"", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<d\[Tau]f2F\>\"", ",", "\"\<dsf2F\>\""}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"frames", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8839481350434847`*^9, 3.883948149933779*^9}, 
   3.883948237482449*^9},
 CellLabel->
  "In[348]:=",ExpressionUUID->"b7bae9f3-176f-4e86-8a69-dc2deac33c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<dtf20E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lhs", ",", "rhs"}], "}"}], ",", 
        RowBox[{"lhs", "->", "rhs"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"table", "[", 
         RowBox[{"[", 
          RowBox[{"Sequence", "@@", "index"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"table", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<dtf20\>\"", "]"}], "]"}], ",", 
            RowBox[{"tables", "[", 
             RowBox[{"[", "\"\<dtf2\>\"", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}], "//", "patternToFunction"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883948984072904*^9, 3.883948990174218*^9}, {
  3.8839490487343063`*^9, 3.8839490829375896`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"d1d2fe28-4cb4-4abe-b000-1e4520d9171f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector calculus operators", "Title",
 CellChangeTimes->{{3.8837834041015043`*^9, 
  3.883783407283782*^9}},ExpressionUUID->"834f35ea-2eb7-4440-9dc8-\
9c67f76f0c5d"],

Cell[CellGroupData[{

Cell["Gradient", "Chapter",
 CellChangeTimes->{{3.8839615128124123`*^9, 
  3.883961514076262*^9}},ExpressionUUID->"ed29a657-f053-4cd1-975f-\
29270a2d5c7a"],

Cell["Gradient scaling coefficients", "Text",
 CellChangeTimes->{{3.883961506121949*^9, 
  3.883961517303631*^9}},ExpressionUUID->"9180b5c3-fda1-4787-825b-\
c2b602e63f8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<hinv\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<h\>\"", "]"}], "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<hinv0\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<h0\>\"", "]"}], "]"}], "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8839605219358788`*^9, 3.883960562378408*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"3ce24e00-96da-40ca-bb5a-83886a682ca9"],

Cell["Connection coefficients for the orthogonal frame", "Text",
 CellChangeTimes->{{3.883961621225151*^9, 
  3.8839616301208277`*^9}},ExpressionUUID->"7c454260-6b0a-4a17-9bd6-\
8c1db839d466"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<gradf2F\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<hinv\>\"", "]"}], "]"}], ".", 
      RowBox[{
       RowBox[{"tables", "[", 
        RowBox[{"[", "\"\<dsf2F\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<gradf2\>\"", "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<hinv0\>\"", "]"}], "]"}], ".", 
      RowBox[{
       RowBox[{"tables", "[", 
        RowBox[{"[", "\"\<dsf20\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<gradf20\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"aa", "@@", "coords"}], ",", 
         RowBox[{"bb", "@@", "coords"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"aa", "@@", "coords"}]}], ",", "0", ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"cc", "[", "\[Sigma]", "]"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"bb", "@@", "coords"}]}], ",", "0", ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"cc", "[", "\[Sigma]", "]"}]}], ",", "0"}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883961012055937*^9, 3.8839611170614853`*^9}, {
  3.883961206615693*^9, 3.8839613243138113`*^9}, {3.883961452343483*^9, 
  3.8839614759213877`*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"adba6f3d-da35-4dae-9386-cf3e970d56f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<gradf20E\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tables", "[", 
          RowBox[{"[", "\"\<gradf20\>\"", "]"}], "]"}], "//", "Flatten"}], 
        ")"}], "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tables", "[", 
          RowBox[{"[", "\"\<gradf2\>\"", "]"}], "]"}], "//", "Flatten"}], 
        ")"}]}], "//", "Thread"}], "//", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "===", "0"}], "||", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "0"}], "]"}], "]"}], "===", "Times"}]}], 
          "]"}], "&"}]}], "]"}], "&"}]}], "//", "patternToFunction"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883961319661281*^9, 3.883961438121294*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"ac355aca-ea72-4941-bd3b-66a1d62c8439"],

Cell["The gradient operator! (In expanded and simplified forms)", "Text",
 CellChangeTimes->{{3.883961637705695*^9, 
  3.8839616495318727`*^9}},ExpressionUUID->"edef075a-0001-44c8-aa80-\
4e03be4670b5"],

Cell[BoxData[
 RowBox[{"Keys", "[", "tables", "]"}]], "Input",
 CellChangeTimes->{{3.883961684319128*^9, 3.88396169117229*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"d9dbd370-0175-4568-924a-85087e4aa7b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradF", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<hinv\>\"", "]"}], "]"}], ".", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"f", ",", 
      RowBox[{"coords", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], 
    "\[Transpose]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradF", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<hinv\>\"", "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"f", ",", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "\[Transpose]"}], 
     ")"}]}], "+", 
   RowBox[{"f", ".", 
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<gradf2F\>\"", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradF", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "2"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<hinv\>\"", "]"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"f", ",", 
          RowBox[{"coords", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ")"}]}], 
    "\[IndentingNewLine]", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<gradf2F\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<gradf2F\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.883960498994217*^9, 3.883960511320251*^9}, {
  3.8839605670761766`*^9, 3.883960567223425*^9}, {3.8839616583412523`*^9, 
  3.883961698171381*^9}, {3.883961742530258*^9, 3.883961762041791*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"6d2e4523-ccd8-4fbf-942b-45269cccbb48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grad0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<hinv0\>\"", "]"}], "]"}], ".", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"f", ",", 
      RowBox[{"coords", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], 
    "\[Transpose]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<hinv0\>\"", "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"f", ",", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], "\[Transpose]"}], 
     ")"}]}], "+", 
   RowBox[{"f", ".", 
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<gradf20\>\"", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "2"}]}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<hinv0\>\"", "]"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"f", ",", 
          RowBox[{"coords", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ")"}]}], 
    "\[IndentingNewLine]", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<gradf20\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", "+", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"tables", "[", 
           RowBox[{"[", "\"\<gradf20\>\"", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "3"}], "}"}]}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.883961898422131*^9, 3.883961919690069*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"cb25be5d-2668-4d09-a966-25023fb5cbac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"us", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "i", "]"}], "@@", "coords"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8839620156436987`*^9, 3.883962032332547*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"cc114711-ec4e-4c3f-aab7-390f47f90441"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyRules", "[", 
    RowBox[{
     RowBox[{"grad0", "[", "us", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\""}],
       "}"}]}], "]"}], "-", 
   RowBox[{"gradF", "[", "us", "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8839620054797907`*^9, 3.88396213540007*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"10a15a0e-c617-4330-978f-6de1b5b4912d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian time derivative", "Chapter",
 CellChangeTimes->{{3.8839619940288773`*^9, 
  3.8839619985851593`*^9}},ExpressionUUID->"7228f487-d079-4165-8cff-\
00782f5d73dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtF", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dtF\>\"", "]"}], "]"}], ".", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"f", ",", "coords"}], "]"}], 
    "\[Transpose]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtF", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<dtF\>\"", "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"f", ",", "coords"}], "]"}], "\[Transpose]"}], ")"}]}], "+", 
   RowBox[{"f", ".", 
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<dtf2F\>\"", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.883962338690116*^9, 3.883962348842051*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"fb908e52-cb05-4cf4-8884-a5f73dcafd6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dt0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "0"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"tables", "[", 
    RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}], ".", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"f", ",", "coords"}], "]"}], 
    "\[Transpose]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"f", ",", "coords"}], "]"}], "\[Transpose]"}], ")"}]}], "+", 
   RowBox[{"f", ".", 
    RowBox[{"tables", "[", 
     RowBox[{"[", "\"\<dtf20\>\"", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.883960470158552*^9, 3.8839604897037*^9}, {
  3.883962176735705*^9, 3.883962224892705*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"7db9f0f4-b947-4d92-9b19-b7b9d10777c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyRules", "[", 
    RowBox[{
     RowBox[{"dt0", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<dtf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\"", ",", 
       "\"\<d\[Tau]f20E\>\"", ",", "\"\<d\[Tau]f10E\>\"", ",", 
       "\"\<vf22f1\>\""}], "}"}]}], "]"}], "-", 
   RowBox[{"dtF", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.883962229100396*^9, 3.8839622322841682`*^9}, {
  3.883962276455776*^9, 3.8839624007214403`*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"8af3a6db-36ac-4d6b-a49b-f1ba7e207c70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<d\[Tau]\[Omega]\>\"", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Sigma]", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "+", 
                   RowBox[{"\[CurlyPhi]", "[", 
                    RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], " ", 
                 RowBox[{"\[Kappa]", "[", 
                  RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}], ")"}], 
             RowBox[{"applyRules", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gradF", "[", 
                 RowBox[{"dtF", "[", "\[Theta]", "]"}], "]"}], "-", 
                RowBox[{"dtF", "[", 
                 RowBox[{"gradF", "[", "\[Theta]", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<d\[Tau]h\>\"", ",", "\"\<d\[Tau]\[Kappa]\>\"", ",", 
                 "\"\<orth\>\""}], "}"}]}], "]"}]}], "//.", 
            RowBox[{
             SubscriptBox["\[PartialD]", "\[Tau]"], 
             RowBox[{"rules", "[", 
              RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}]}]}], "/.", 
           RowBox[{"rules", "[", 
            RowBox[{"[", "\"\<d\[Tau]h\>\"", "]"}], "]"}]}], "//", 
          "Simplify"}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"h", "->", 
          RowBox[{"(", 
           RowBox[{"1", "&"}], ")"}]}], "*)"}], "//", "Expand"}], ")"}], "[", 
      
      RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         SuperscriptBox["\[Omega]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8839629240929813`*^9, 3.883963085741706*^9}, {
  3.883963147984598*^9, 3.883963192797524*^9}, {3.883963360792531*^9, 
  3.883963362439907*^9}, {3.883963506448834*^9, 3.8839635087140207`*^9}, {
  3.883963590940769*^9, 3.883963612869138*^9}, {3.883964813078548*^9, 
  3.883964856299067*^9}, {3.8839648904018307`*^9, 3.883964990459405*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"2656d42c-4204-4ce6-9461-1364f74f6950"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ")"}], "@", 
        RowBox[{"rules", "[", 
         RowBox[{"[", "\"\<d\[Tau]\[Omega]\>\"", "]"}], "]"}]}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", "Expand"}], 
    "//", 
    RowBox[{
     RowBox[{"toTeX", "[", 
      RowBox[{"#", ",", "uordering"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<+\>\"", "->", "\"\<\n+\>\""}], ",", 
        RowBox[{"\"\<-\>\"", "->", "\"\<\n-\>\""}]}], "}"}]}], "]"}], "&"}]}],
   "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/dtauomega.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.883964995679137*^9, 3.883965054016164*^9}, {
  3.883965135221945*^9, 3.8839651722260313`*^9}, {3.883965761651167*^9, 
  3.883965804421286*^9}, {3.883965870274693*^9, 3.8839659143540707`*^9}},
 CellLabel->
  "In[555]:=",ExpressionUUID->"1bdae79b-ce62-486c-a50b-e9a7f339f207"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Sigma]", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "+", 
                RowBox[{"\[CurlyPhi]", "[", 
                 RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], " ", 
              RowBox[{"\[Kappa]", "[", 
               RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}], ")"}], 
          RowBox[{"applyRules", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"grad0", "[", 
              RowBox[{"dt0", "[", "\[Theta]", "]"}], "]"}], "-", 
             RowBox[{"dt0", "[", 
              RowBox[{"grad0", "[", "\[Theta]", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<dtf20E\>\"", ",", "\"\<dsf20E\>\"", ",", 
              "\"\<d\[Tau]f20E\>\"", ",", "\"\<d\[Tau]f10E\>\"", ",", 
              "\"\<h0E\>\"", ",", "\"\<vf22f1\>\"", ",", "\"\<d\[Tau]h\>\"", 
              ",", "\"\<d\[Tau]\[Kappa]\>\"", ",", "\"\<orth\>\""}], "}"}]}], 
           "]"}]}], "//.", 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Tau]"], 
          RowBox[{"rules", "[", 
           RowBox[{"[", "\"\<orth\>\"", "]"}], "]"}]}]}], "//", "Simplify"}], 
       ")"}], "/.", 
      RowBox[{"h", "->", 
       RowBox[{"(", 
        RowBox[{"1", "&"}], ")"}]}]}], "//", "Expand"}], ")"}], "//.", 
   "cleanup"}], "*)"}]], "Input",
 CellChangeTimes->{{3.883964653927513*^9, 3.883964763813552*^9}, {
  3.883965112365456*^9, 
  3.883965129616928*^9}},ExpressionUUID->"91a7833c-cd6d-428d-b2e6-\
4ac324a6c51e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "fe316881-bf62-48e2-8f8d-24ff1a444c91"],
 " formatting"
}], "Chapter",
 CellChangeTimes->{{3.880580487229842*^9, 
  3.8805804907865143`*^9}},ExpressionUUID->"5b7e8192-aa2b-40a8-8a7b-\
db6301b86a06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cleanup", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"f_", "[", "\[Sigma]", "]"}], "->", "f"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f_", "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", "f"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f_", "[", 
       RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], "->", "f"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f_", "[", 
       RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
      "->", "f"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"i_", "/;", 
          RowBox[{"i", ">", "0"}]}], ",", "j_"}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "s"], "i"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "j"}], "]"}], "[", "f", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", 
         RowBox[{"j_", "/;", 
          RowBox[{"j", ">", "0"}]}]}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Tau]"], "j"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "0"}], "]"}], "[", "f", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"i_", "/;", 
          RowBox[{"i", ">", "0"}]}], ",", "j_", ",", "k_"}], "]"}], "[", "f_",
        "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "s"], "i"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "j", ",", "k"}], "]"}], "[", "f", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", 
         RowBox[{"j_", "/;", 
          RowBox[{"j", ">", "0"}]}], ",", "k_"}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Theta]"], "j"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "0", ",", "k"}], "]"}], "[", "f", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", 
         RowBox[{"k_", "/;", 
          RowBox[{"k", ">", "0"}]}]}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Tau]"], "k"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "0"}], "]"}], "[", "f", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"i_", "/;", 
          RowBox[{"i", ">", "0"}]}], ",", "j_", ",", "k_", ",", "l_"}], "]"}],
        "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "s"], "i"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "j", ",", "k", ",", "l"}], "]"}], "[", "f", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", 
         RowBox[{"j_", "/;", 
          RowBox[{"j", ">", "0"}]}], ",", "k_", ",", "l_"}], "]"}], "[", "f_",
        "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Sigma]"], "j"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "0", ",", "k", ",", "l"}], "]"}], "[", "f", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", 
         RowBox[{"k_", "/;", 
          RowBox[{"k", ">", "0"}]}], ",", "l_"}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Theta]"], "k"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "0", ",", "l"}], "]"}], "[", "f", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", 
         RowBox[{"l_", "/;", 
          RowBox[{"l", ">", "0"}]}]}], "]"}], "[", "f_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Tau]"], "l"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "0"}], "]"}], "[", "f", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"x__", "/;", 
         RowBox[{
          RowBox[{"Sum", "[", "x", "]"}], "==", "0"}]}], "]"}], "[", "f_", 
       "]"}], "->", "f"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"HoldForm", "[", 
        SuperscriptBox[
         SubscriptBox["d", "x_"], "1"], "]"}], "[", "f_", "]"}], ":>", 
      RowBox[{
       SubscriptBox["d", "x"], "[", "f", "]"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "->", 
      SubscriptBox["u", "s"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "->", 
      SubscriptBox["u", "\[Sigma]"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "->", 
      SubscriptBox["u", "\[Theta]"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"hs", "->", 
      SubscriptBox["h", "s"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"h\[Theta]", "->", 
      SubscriptBox["h", "\[Theta]"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"vt", "->", 
      SubscriptBox["v", "t"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"vn", "->", 
      SubscriptBox["v", "n"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"vb", "->", 
      SubscriptBox["v", "b"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"v\[Sigma]", "->", 
      SubscriptBox["v", "\[Sigma]"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"v\[Theta]", "->", 
      SubscriptBox["v", "\[Theta]"]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.880144087935164*^9, 3.880144260232524*^9}, {
   3.880144583254797*^9, 3.8801445991625433`*^9}, {3.88014568159814*^9, 
   3.880145689393021*^9}, {3.880146484428396*^9, 3.880146487530059*^9}, {
   3.880578415353829*^9, 3.8805784213006897`*^9}, {3.880578454231906*^9, 
   3.880578598819558*^9}, {3.880599189584599*^9, 3.880599265083344*^9}, {
   3.880642826093656*^9, 3.880642885478656*^9}, {3.880644514053815*^9, 
   3.880644541356056*^9}, {3.880644581505928*^9, 3.880644581935978*^9}, {
   3.880644622670977*^9, 3.880644634677765*^9}, {3.8806484691888723`*^9, 
   3.8806485052452173`*^9}, 3.882643063678918*^9, {3.88306452099527*^9, 
   3.883064524428892*^9}, {3.883093978942519*^9, 3.883093993108838*^9}, {
   3.8831014172528257`*^9, 3.883101429920587*^9}, {3.8838640624211473`*^9, 
   3.883864066476129*^9}, {3.883880106013528*^9, 3.883880113223419*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"4a5f0ebf-c05e-45eb-a391-2deb90a0a9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vectorStringsList", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"TeXForm", "[", 
         OverscriptBox["c", "^"], "]"}], "//", "ToString"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "n", ",", "b"}], "}"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"TeXForm", "[", 
         SubscriptBox[
          OverscriptBox["t", "^"], "c"], "]"}], "//", "ToString"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]"}], "}"}]}], "}"}]}], 
      "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.880581954216481*^9, 3.8805819955766363`*^9}, 
   3.882643063681788*^9, {3.88309403911833*^9, 3.8830940926769648`*^9}, {
   3.8830942632908792`*^9, 3.883094263618453*^9}, {3.883094400252729*^9, 
   3.883094400867571*^9}, {3.883094434502256*^9, 3.883094434873839*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"195826a5-38c1-4d03-8dac-08e806eb4294"],

Cell[BoxData[
 RowBox[{
  RowBox[{"toTeX", "[", 
   RowBox[{"exp_", ",", "vectorStrings_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Which", "[", "\n", "  ", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{
      RowBox[{"Head", "[", "exp", "]"}], " ", "===", " ", "List"}], "]"}], 
    ",", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"exp", " ", "//", " ", "TeXForm"}], " ", "//", " ", 
        "ToString"}], " ", "//", " ", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"\"\<d_\>\"", " ", "->", " ", "\"\<\\\\partial_\>\""}]}], 
         "]"}], " ", "&"}]}], " ", "//", " ", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"#", ",", "\n", "     ", 
         RowBox[{
          RowBox[{"\"\<\\\\partial_\>\"", " ", "~~", " ", 
           RowBox[{"Shortest", "[", "x__", "]"}], " ", "~~", " ", 
           RowBox[{"(", 
            RowBox[{"\"\<\\\\left(\>\"", " ", "|", " ", "\"\<(\>\""}], ")"}], 
           " ", "~~", " ", 
           RowBox[{"Shortest", "[", "y__", "]"}], " ", "~~", " ", 
           RowBox[{"(", 
            RowBox[{"\"\<\\\\right)\>\"", " ", "|", " ", "\"\<)\>\""}], 
            ")"}]}], " ", ":>", " ", 
          RowBox[{
          "\"\<\\\\partial_\>\"", " ", "~~", " ", "x", " ", "~~", " ", 
           "\"\< \>\"", " ", "~~", " ", "y"}]}]}], "]"}], " ", "&"}]}], "//", 
     
     RowBox[{
      RowBox[{"StringReplace", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\"\<\\\\partial_s\>\"", "->", "\"\<\\\\nabla_s\>\""}]}], 
       "]"}], "&"}]}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"TensorRank", "[", "exp", "]"}], " ", "==", " ", "1"}], ",", 
    "\n", "  ", 
    RowBox[{"StringRiffle", "[", "\n", "   ", 
     RowBox[{
      RowBox[{"Table", "[", "\n", "    ", 
       RowBox[{
        RowBox[{"If", "[", "\n", "     ", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{
            RowBox[{"exp", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "===", " ", "0"}], "]"}], 
          ",", "\n", "     ", 
          RowBox[{"\"\<\\\\left(\>\"", " ", "<>", " ", 
           RowBox[{"toTeX", "[", 
            RowBox[{
             RowBox[{"exp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "vectorStrings"}], "]"}], 
           " ", "<>", " ", "\"\<\\\\right)\>\"", " ", "<>", " ", 
           RowBox[{"vectorStrings", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "\n", "     ", "Nothing"}],
          "]"}], ",", "\n", "    ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], ",", "\n", "   ", 
      "\"\<\n + \>\""}], "]"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"TensorRank", "[", "exp", "]"}], " ", "==", " ", "2"}], ",", 
    "\n", "  ", 
    RowBox[{"StringRiffle", "[", "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", "\n", "     ", 
        RowBox[{
         RowBox[{"If", "[", "\n", "      ", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{
             RowBox[{"exp", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "===", " ", 
             "0"}], "]"}], ",", "\n", "      ", 
           RowBox[{"\"\<\\\\left(\>\"", " ", "<>", " ", 
            RowBox[{"toTeX", "[", 
             RowBox[{
              RowBox[{"exp", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], ",", 
              "vectorStrings"}], "]"}], " ", "<>", " ", "\"\<\\\\right)\>\"", 
            " ", "<>", " ", 
            RowBox[{"vectorStrings", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "<>", " ", 
            RowBox[{"vectorStrings", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", "      ", 
           "Nothing"}], "]"}], ",", "\n", "     ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "3"}], "}"}]}], "]"}], " ", "//", " ", 
       "Flatten"}], ",", "\n", "   ", "\"\<\n + \>\""}], "]"}]}], "\n", "  ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.880578642137776*^9, 3.880578697570449*^9}, {
   3.880578779521358*^9, 3.880578780817442*^9}, {3.880578867128518*^9, 
   3.880578901865603*^9}, {3.880579505006782*^9, 3.8805795186652727`*^9}, {
   3.880580023284073*^9, 3.880580098078466*^9}, 3.880580264928855*^9, 
   3.880580334793819*^9, 3.8805804339477997`*^9, {3.880580863267873*^9, 
   3.880580863624042*^9}, {3.880580925461429*^9, 3.8805809574399357`*^9}, {
   3.880581016819715*^9, 3.880581022242125*^9}, {3.880581164992279*^9, 
   3.880581176615363*^9}, {3.880581263058753*^9, 3.880581459372229*^9}, {
   3.880581508981598*^9, 3.880581707245997*^9}, {3.88058178276775*^9, 
   3.880581809849654*^9}, {3.880582002877911*^9, 3.88058202049175*^9}, {
   3.880598723008602*^9, 3.8805987261381407`*^9}, 3.882643063690349*^9, {
   3.883052577964828*^9, 3.883052577973461*^9}, {3.883064374966217*^9, 
   3.8830643938062143`*^9}, {3.88309402738976*^9, 3.883094030489396*^9}, {
   3.88309414058357*^9, 3.8830941443308992`*^9}, {3.8830942660261583`*^9, 
   3.8830942716182413`*^9}, {3.883094343390325*^9, 3.883094343576456*^9}, {
   3.88309454400817*^9, 3.8830945660912323`*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"659b43ad-2ed9-4243-bcf7-3cfd7c418726"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"jetOrdering", "[", 
   RowBox[{"exp_", ",", "ordering_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coeffs", ",", " ", "out"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"coeffs", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"exp", ",", " ", "v"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"v", ",", " ", "ordering"}], "}"}]}], "]"}]}], ";", "\n", 
     "  ", 
     RowBox[{"out", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ci", ",", " ", "vi"}], "}"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"ci", " ", "===", " ", "0"}], "]"}], ",", 
            RowBox[{"ci", " ", "vi"}], ",", " ", "Nothing"}], "]"}]}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"coeffs", ",", " ", "ordering"}], "}"}]}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Replace", "[", 
      RowBox[{"out", ",", " ", 
       RowBox[{
        RowBox[{"List", "[", "x__", "]"}], " ", ":>", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Plus", "[", "x", "]"}], "]"}]}]}], "]"}]}]}], "\n", "  ", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"us", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"u", "[", "i", "]"}], "@@", "coords"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uordering", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"us", ",", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", 
            RowBox[{";;", " ", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", " ", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{"us", ",", " ", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", " ", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", " ", "us"}], 
     "]"}], " ", "//", " ", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fordering", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{"f", "@@", "coords"}], ",", " ", 
          RowBox[{"coords", "[", 
           RowBox[{"[", 
            RowBox[{";;", " ", 
             RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", " ", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"f", "@@", "coords"}], ",", " ", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{";;", " ", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", " ", 
       RowBox[{"f", "@@", "coords"}], "}"}]}], "]"}], " ", "//", " ", 
    "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.880580594681675*^9, {3.880580678013072*^9, 3.8805806937633953`*^9}, 
   3.882643063693495*^9, {3.8830525986286163`*^9, 3.883052610780238*^9}, 
   3.8830644057908907`*^9, {3.883072935384369*^9, 3.883072978093872*^9}, {
   3.8830731691426888`*^9, 3.883073179916045*^9}, {3.883073247242079*^9, 
   3.883073252113467*^9}, {3.883079510762971*^9, 3.883079554811989*^9}, {
   3.88307964604385*^9, 3.8830796472141542`*^9}, {3.8837831214605494`*^9, 
   3.883783133330083*^9}, {3.883860304035696*^9, 3.883860339786645*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"a9e880dc-cc0c-4bd9-acc7-78f54b7619f6"],

Cell[CellGroupData[{

Cell[TextData[{
 "Generating ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "f6b29423-7b98-4acf-a30b-f44e1df3520f"],
 " strings"
}], "Subsection",
 CellChangeTimes->{{3.883783186932308*^9, 
  3.8837831925295877`*^9}},ExpressionUUID->"9b237b80-4b40-47c8-bdbb-\
a7dfb93140eb"],

Cell["\<\
We simplify to arclength derivatives throughout by applying the rule (h = 1).\
\
\>", "Text",
 CellChangeTimes->{{3.883850010466558*^9, 
  3.883850025520454*^9}},ExpressionUUID->"4f7c01c5-570c-420a-b481-\
fc9b0b83d455"],

Cell[BoxData[{
 RowBox[{"MapThread", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"toTeX", "[", 
         RowBox[{"#", ",", 
          RowBox[{"vectorStringsList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/.", 
          RowBox[{"h", "->", 
           RowBox[{"(", 
            RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], ")"}]}], "//", 
      
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<expressions/dt``.txt\>\"", ",", "f"}], "]"}], "]"}], 
         ",", "#"}], "]"}], "&"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "n", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"h", "->", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/dtrule1.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", "0"}], "//", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       SuperscriptBox["vt", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tables", "[", 
            RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], 
          RowBox[{"\[Kappa]", "[", 
           RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["vt", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"s", ",", "\[Tau]"}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"s", ",", "\[Tau]"}], "]"}], " ", 
             RowBox[{"vn", "[", 
              RowBox[{"s", ",", "\[Tau]"}], "]"}], " ", 
             RowBox[{"\[Kappa]", "[", 
              RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["h", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"0", ",", "1"}], ")"}],
               Derivative],
              MultilineFunction->None], "[", 
             RowBox[{"s", ",", "\[Tau]"}], "]"}]}]}], ")"}]}], ")"}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "//", "Simplify"}], ")"}], "//.", 
    "cleanup"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/dtrule2.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{"h", "->", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/alpha.txt\>\"", ",", "#"}], "]"}], "&"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
     RowBox[{"h", "->", 
      RowBox[{"(", 
       RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/beta.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "//", "Simplify"}], ")"}], "//.", 
    "cleanup"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/gamma.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.883095222671308*^9, 3.883095249929811*^9}, {
  3.8830952898771477`*^9, 3.883095353305276*^9}, {3.883095442079561*^9, 
  3.883095466313951*^9}, {3.883095527808899*^9, 3.883095630507362*^9}, {
  3.883783204527854*^9, 3.8837832309443502`*^9}, {3.883933088704427*^9, 
  3.8839330887173223`*^9}},ExpressionUUID->"e95f998e-37ee-44fa-8704-\
a42ec544ea82"],

Cell["Check the definitions of \[Alpha],\[Beta],\[Gamma]", "Text",
 CellChangeTimes->{{3.8838502176914663`*^9, 
  3.8838502250794773`*^9}},ExpressionUUID->"a00b40c5-f251-4c6a-ab3a-\
2307fda98e9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Kappa]", "[", 
      RowBox[{"s", ",", "\[Tau]"}], "]"}], 
     RowBox[{
      RowBox[{"tables", "[", 
       RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", 
        RowBox[{"s", ",", "\[Tau]"}], "]"}], 
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
      RowBox[{
       SubscriptBox["\[PartialD]", "s"], 
       RowBox[{
        RowBox[{"tables", "[", 
         RowBox[{"[", "\"\<d\[Tau]f1\>\"", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], "/.", 
   RowBox[{"h", "->", 
    RowBox[{"(", 
     RowBox[{"1", "&"}], ")"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.883097300012384*^9, 3.883097329608787*^9}, {
  3.883097474895864*^9, 3.883097541905896*^9}, {3.883933088719513*^9, 
  3.883933088722131*^9}},ExpressionUUID->"111a3eda-66d9-4b22-a934-\
561a30c60eaf"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Printing vector calculus operators", "Chapter",
 CellChangeTimes->{{3.883966099222848*^9, 
  3.88396610776521*^9}},ExpressionUUID->"a64a53e3-b20e-4767-a04f-\
0a61cba6f22b"],

Cell[TextData[StyleBox["Connection coefficients", "Subsection"]], "Text",
 CellChangeTimes->{{3.883966403741743*^9, 
  3.8839664220044203`*^9}},ExpressionUUID->"c2da3286-1bff-458c-b508-\
3ba8ecaa74eb"],

Cell[BoxData[
 RowBox[{"applyRules", "[", 
  RowBox[{
   RowBox[{"grad0", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\""}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883966142805891*^9, 3.883966209382984*^9}, {
  3.8839662515777273`*^9, 3.8839662850476713`*^9}},
 CellLabel->
  "In[562]:=",ExpressionUUID->"14b72bc8-f610-41e7-b810-d0b3b8b62583"],

Cell[CellGroupData[{

Cell["Vector gradient", "Subsection",
 CellChangeTimes->{{3.8839664102870407`*^9, 
  3.883966427169383*^9}},ExpressionUUID->"eafe127d-9050-4b0d-bb0d-\
da786b9fe74d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"grad0", "[", "us", "]"}], "//.", "cleanup"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.8839663849936113`*^9, 3.883966390346285*^9}},
 CellLabel->
  "In[568]:=",ExpressionUUID->"afb0db13-e758-412e-8fb6-1c5732dd87d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector divergence", "Subsection",
 CellChangeTimes->{{3.8839664355638847`*^9, 
  3.8839664402593517`*^9}},ExpressionUUID->"8a8e9c80-ca15-43a2-9e00-\
05c7c31b6b22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tr", "[", 
   RowBox[{"grad0", "[", "us", "]"}], "]"}], "//.", "cleanup"}]], "Input",
 CellChangeTimes->{{3.883966376041483*^9, 3.883966394928342*^9}},
 CellLabel->
  "In[570]:=",ExpressionUUID->"fe1f7f48-282c-4048-926c-6e04ccd66086"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar Laplacian", "Subsection",
 CellChangeTimes->{{3.88396673381089*^9, 
  3.8839667363547773`*^9}},ExpressionUUID->"77d9002b-8545-4112-b4e9-\
737d94db8fb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"grad0", "[", 
     RowBox[{"grad0", "[", 
      RowBox[{"f", "@@", "coords"}], "]"}], "]"}], "]"}], "//.", "cleanup"}], 
  "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.883966737804644*^9, 3.883966757342811*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"3c0c191e-0631-4734-8717-a49273048604"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector curl", "Subsection",
 CellChangeTimes->{{3.8839664920056543`*^9, 
  3.883966493991825*^9}},ExpressionUUID->"9599539a-e515-491e-b18b-\
241f88460d48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorContract", "[", 
   RowBox[{
    RowBox[{"eps", "\[TensorProduct]", 
     RowBox[{"grad0", "[", "us", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}], "//.", 
  "cleanup"}]], "Input",
 CellChangeTimes->{{3.8839664992048817`*^9, 3.883966569716832*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"64eda5f6-7de8-4498-95fe-5f73a8499a77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Laplacian", "Subsection",
 CellChangeTimes->{{3.883966675134095*^9, 
  3.8839666778321533`*^9}},ExpressionUUID->"1138ab8c-d5c1-4343-a42d-\
d45e4caec251"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"grad0", "[", 
           RowBox[{"grad0", "[", "us", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "//", "Simplify"}], ")"}],
       "//.", "cleanup"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"grad0", "[", 
           RowBox[{"grad0", "[", 
            RowBox[{"us", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "//.", "cleanup"}], "//", 
      "Simplify"}], ")"}]}], "//", "Simplify"}], "//", "TableForm"}]], "Input",\

 CellChangeTimes->{{3.883966679358261*^9, 3.883966719829205*^9}, {
  3.883966873907351*^9, 3.8839669013111362`*^9}, {3.883966934959714*^9, 
  3.883966946273922*^9}, {3.88396697784829*^9, 3.8839669875466948`*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"b9916b3a-b648-406c-9776-6a447f57ed77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moving time derivatives of Frenet-Serret frame", "Subsection",
 CellChangeTimes->{{3.883967172870661*^9, 
  3.8839671805149517`*^9}},ExpressionUUID->"6599d6ab-5ef2-46fe-bc70-\
3b0906299206"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<d\[Tau]f10\>\"", "]"}], "]"}], "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f10E\>\"", "]"}], "]"}]}], "/.", 
    RowBox[{"h", "->", 
     RowBox[{"(", 
      RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.883967187484439*^9, 3.883967234229518*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"29858c63-d768-414a-aaae-1e09540439a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moving time derivatives of orthonormal frame", "Subsection",
 CellChangeTimes->{{3.883967172870661*^9, 3.8839671805149517`*^9}, {
  3.883967281694401*^9, 
  3.883967284538066*^9}},ExpressionUUID->"7c66db1b-e406-4a18-b4c5-\
335e4818fa46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"tables", "[", 
      RowBox[{"[", "\"\<d\[Tau]f20\>\"", "]"}], "]"}], "/.", 
     RowBox[{"rules", "[", 
      RowBox[{"[", "\"\<d\[Tau]f20E\>\"", "]"}], "]"}]}], "/.", 
    RowBox[{"h", "->", 
     RowBox[{"(", 
      RowBox[{"1", "&"}], ")"}]}]}], "//.", "cleanup"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.883967187484439*^9, 3.883967234229518*^9}, {
  3.883967288602194*^9, 3.883967290635573*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"8d01f408-727f-4b08-b80c-f4d8c7cfd749"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian time derivative of curve coordinates", "Subsection",
 CellChangeTimes->{{3.8839673242873077`*^9, 
  3.8839673356862097`*^9}},ExpressionUUID->"43102865-0852-43f9-8263-\
7901db56976d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tables", "[", 
   RowBox[{"[", "\"\<dt0\>\"", "]"}], "]"}], "//.", "cleanup"}]], "Input",
 CellChangeTimes->{{3.883967336877483*^9, 3.883967365667036*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"5bf02cdf-22fb-4962-a136-91d5ddf43957"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian time derivatives of orthonormal frame", "Subsection",
 CellChangeTimes->{{3.883967445230945*^9, 
  3.883967454755207*^9}},ExpressionUUID->"619f9bff-267b-4f5b-920d-\
c7d19db2fa22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tables", "[", 
   RowBox[{"[", "\"\<dtf2\>\"", "]"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.883967828307335*^9, 3.883967881663704*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"689f7a87-88fa-47c3-82c5-66734c80adff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyRules", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]2", "[", 
      RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
     "+", 
     FractionBox[
      RowBox[{"\[Sigma]", " ", 
       RowBox[{"AA", "[", 
        RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], " ", 
       RowBox[{"\[Alpha]2", "[", 
        RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], 
        "]"}]}], 
      RowBox[{"hs", "[", 
       RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], 
       "]"}]]}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<dsf20E\>\"", ",", "\"\<h0E\>\""}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.883967889416353*^9, 3.883967941878387*^9}},
 CellLabel->
  "In[619]:=",ExpressionUUID->"9b32c88d-5c66-4b83-8b04-7e4576d943b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyRules", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]2", "[", 
      RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], 
     "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"v\[Theta]", "[", 
         RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], "-", 
       RowBox[{"\[Sigma]", " ", 
        RowBox[{"\[Gamma]2", "[", 
         RowBox[{"s", ",", "\[Sigma]", ",", "\[Theta]", ",", "\[Tau]"}], 
         "]"}]}]}], 
      RowBox[{"h\[Theta]", "[", "\[Sigma]", "]"}]]}], ",", 
    RowBox[{"{", "\"\<h0E\>\"", "}"}]}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{
  3.883967970284623*^9, {3.8839683407344847`*^9, 3.8839683513023767`*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"3dc023f2-08f3-4b9f-a06a-e3d87e2154cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian time derivative of scalar", "Subsection",
 CellChangeTimes->{{3.8839684347368593`*^9, 
  3.883968438987095*^9}},ExpressionUUID->"384f5fec-279c-42b9-9be4-\
efc7c6f23cca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dt0", "[", 
   RowBox[{"f", "@@", "coords"}], "]"}], "//.", "cleanup"}]], "Input",
 CellChangeTimes->{{3.883968440378767*^9, 3.883968448347145*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"55031bac-a050-4832-b6d9-9649072ba2ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian time derivative of vector", "Subsection",
 CellChangeTimes->{{3.883968480335536*^9, 
  3.883968488652047*^9}},ExpressionUUID->"931effb2-67d6-42e1-91b3-\
e7e9e1fa8deb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dt0", "[", "us", "]"}], "-", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"dt0", "[", 
      RowBox[{"us", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "//.", "cleanup"}]], "Input",\

 CellChangeTimes->{{3.883968489894541*^9, 3.883968515761879*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"4f70b65c-1434-496f-a1c6-a803881c91a3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Asymptotics", "Chapter",
 CellChangeTimes->{{3.8801664370177097`*^9, 
  3.8801664383982153`*^9}},ExpressionUUID->"3188071f-e9bb-4851-9d99-\
bb7458570b01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{"f", ",", 
     RowBox[{"u", "[", "1", "]"}], ",", 
     RowBox[{"u", "[", "2", "]"}], ",", 
     RowBox[{"u", "[", "3", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.882642792546897*^9, 3.882642803844475*^9}, {
  3.883101994194231*^9, 3.8831020011317587`*^9}, {3.883103105318366*^9, 
  3.8831031058321543`*^9}, {3.883103161841284*^9, 3.883103161964899*^9}, {
  3.8839688392302637`*^9, 3.883968840179494*^9}, {3.883969011766912*^9, 
  3.883969021857979*^9}},ExpressionUUID->"37f1d0a1-beff-4a86-b659-\
2b2716bc6487"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rescaling", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"g_", "/;", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"vars", ",", "g"}], "]"}]}], "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"#1", ",", 
          FractionBox["#2", "\[CurlyEpsilon]"], ",", "#3", ",", "#4"}], "]"}],
         "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]", "->", 
      RowBox[{"\[CurlyEpsilon]", " ", "\[Xi]"}]}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.882642727885069*^9, 3.882642883024287*^9}, {
  3.8826429327071247`*^9, 3.882642936182539*^9}, {3.882643629145348*^9, 
  3.8826436357988853`*^9}, {3.883102046608451*^9, 3.883102049585532*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"f80f13ab-d63c-4f23-b2c7-f7d9063057af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cleanupRescaled", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"g_", "[", 
       RowBox[{"s", ",", "\[Tau]"}], "]"}], "->", "g"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g_", "[", 
       RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], "->", "g"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g_", "[", 
       RowBox[{"s", ",", "\[Xi]", ",", "\[Theta]", ",", "\[Tau]"}], "]"}], "->",
       "g"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"i_", "/;", 
          RowBox[{"i", ">", "0"}]}], ",", "j_"}], "]"}], "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "s"], "i"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "j", ",", "k"}], "]"}], "[", "g", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", 
         RowBox[{"j_", "/;", 
          RowBox[{"j", ">", "0"}]}]}], "]"}], "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Tau]"], "j"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "0", ",", "k"}], "]"}], "[", "g", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", 
         RowBox[{"k_", "/;", 
          RowBox[{"k", ">", "0"}]}]}], "]"}], "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "t"], "k"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "0"}], "]"}], "[", "g", "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{
         RowBox[{"i_", "/;", 
          RowBox[{"i", ">", "0"}]}], ",", "j_", ",", "k_", ",", "l_"}], "]"}],
        "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "s"], "i"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "j", ",", "k", ",", "l"}], "]"}], "[", "g", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", 
         RowBox[{"j_", "/;", 
          RowBox[{"j", ">", "0"}]}], ",", "k_", ",", "l_"}], "]"}], "[", "g_",
        "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Xi]"], "j"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "0", ",", "k", ",", "l"}], "]"}], "[", "g", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", 
         RowBox[{"k_", "/;", 
          RowBox[{"k", ">", "0"}]}], ",", "l_"}], "]"}], "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Theta]"], "k"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "0", ",", "l"}], "]"}], "[", "g", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"i_", ",", "j_", ",", "k_", ",", 
         RowBox[{"l_", "/;", 
          RowBox[{"l", ">", "0"}]}]}], "]"}], "[", "g_", "]"}], "->", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["d", "\[Tau]"], "l"], "[", 
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"i", ",", "j", ",", "k", ",", "0"}], "]"}], "[", "g", "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"x__", "/;", 
         RowBox[{
          RowBox[{"Sum", "[", "x", "]"}], "==", "0"}]}], "]"}], "[", "g_", 
       "]"}], "->", "g"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], "\[Rule]", 
      SubscriptBox["u", "s"]}], ",", 
     RowBox[{
      RowBox[{"u", "[", "2", "]"}], "\[Rule]", 
      SubscriptBox["u", "\[Sigma]"]}], ",", 
     RowBox[{
      RowBox[{"u", "[", "3", "]"}], "\[Rule]", 
      SubscriptBox["u", "\[Theta]"]}], ",", 
     RowBox[{"vt", "\[Rule]", 
      SubscriptBox["v", "t"]}], ",", 
     RowBox[{"vn", "\[Rule]", 
      SubscriptBox["v", "n"]}], ",", 
     RowBox[{"vb", "\[Rule]", 
      SubscriptBox["v", "b"]}], ",", 
     RowBox[{"v\[Sigma]", "\[Rule]", 
      SubscriptBox["v", "\[Sigma]"]}], ",", 
     RowBox[{"v\[Theta]", "\[Rule]", 
      SubscriptBox["v", "\[Theta]"]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.882645338392096*^9, 3.882645340032299*^9}, {
  3.882645388922933*^9, 3.882645447133651*^9}, {3.882645544959074*^9, 
  3.882645545343878*^9}, {3.883102085283846*^9, 3.8831022066868*^9}, {
  3.8831033304897747`*^9, 3.883103350149877*^9}, {3.883974343677411*^9, 
  3.883974346792201*^9}},
 CellLabel->
  "In[763]:=",ExpressionUUID->"9f882a8b-f789-4d11-9345-034621cf3377"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<trig\>\"", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "+", 
        RowBox[{"\[CurlyPhi]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "->", "sn"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "+", 
        RowBox[{"\[CurlyPhi]", "[", 
         RowBox[{"s", ",", "\[Tau]"}], "]"}]}], "]"}], "->", "cs"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8831033419200783`*^9, 3.883103367873001*^9}, {
  3.8839693013058987`*^9, 3.8839693153081713`*^9}},
 CellLabel->
  "In[649]:=",ExpressionUUID->"a389002c-56eb-4c8f-8737-41ae109d6912"],

Cell[CellGroupData[{

Cell["Gradient scalar", "Subsection",
 CellChangeTimes->{{3.882642705371915*^9, 3.8826427109400167`*^9}, {
  3.8826457280044527`*^9, 
  3.882645728794877*^9}},ExpressionUUID->"d56ff32e-517d-46f2-a3a7-\
bd5264cdf6cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"applyRules", "[", 
       RowBox[{
        RowBox[{"grad0", "[", 
         RowBox[{"f", "@@", "coords"}], "]"}], ",", 
        RowBox[{"{", "\"\<h0E\>\"", "}"}]}], "]"}], "/.", 
      RowBox[{"h", "->", 
       RowBox[{"(", 
        RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
     "&"}]}], ")"}], "//.", "cleanupRescaled"}]], "Input",
 CellChangeTimes->{{3.883968649997466*^9, 3.883968722250699*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"53597146-ced9-4f9f-8733-131bcc13b1e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gradient vector", "Subsection",
 CellChangeTimes->{{3.883968771837523*^9, 
  3.8839687739378433`*^9}},ExpressionUUID->"c9900710-dc7d-409f-afc8-\
9ef5c2c39344"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"applyRules", "[", 
        RowBox[{
         RowBox[{"grad0", "[", "us", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<gradf20E\>\"", ",", "\"\<h0E\>\"", ",", "\"\<dsf20E\>\"", ",", 
           "\"\<trig\>\""}], "}"}]}], "]"}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
      "&"}]}], ")"}], "//.", "cleanupRescaled"}], "//", "TableForm", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"toTeX", "[", 
        RowBox[{"#", ",", 
         RowBox[{"vectorStringsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<expressions/eps-grad-u.txt\>\"", ",", "#"}], "]"}], 
     "&"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.883968783274757*^9, 3.883968793247913*^9}, {
  3.883969039312603*^9, 3.883969056828876*^9}, {3.88396913244562*^9, 
  3.883969146548541*^9}, {3.883969274536057*^9, 3.8839692861329613`*^9}, {
  3.883969335550041*^9, 3.883969428753153*^9}},
 CellLabel->
  "In[658]:=",ExpressionUUID->"c150067f-b696-4a0f-97a2-5ceec036e7cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Divergence", "Subsection",
 CellChangeTimes->{{3.883969504417214*^9, 
  3.883969506637354*^9}},ExpressionUUID->"617e96ef-4e01-4578-abd1-\
7babda161f05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"applyRules", "[", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"grad0", "[", "us", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<gradf20E\>\"", ",", "\"\<h0E\>\"", ",", "\"\<dsf20E\>\"", ",", 
           "\"\<trig\>\""}], "}"}]}], "]"}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
      "&"}]}], ")"}], "//.", "cleanupRescaled"}], "//", "TableForm", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"toTeX", "[", 
        RowBox[{"#", ",", 
         RowBox[{"vectorStringsList", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<expressions/eps-grad-u.txt\>\"", ",", "#"}], "]"}], 
     "&"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8839695251307993`*^9, 3.883969527172563*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"d5aaa4cc-ca54-4e23-a224-74ab5fb6f10b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar Laplacian", "Subsection",
 CellChangeTimes->{{3.883969614153282*^9, 
  3.8839696188231907`*^9}},ExpressionUUID->"9f322cd9-a8cc-4d13-b108-\
7e038d7f5c0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"applyRules", "[", 
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{"grad0", "[", 
             RowBox[{"grad0", "[", 
              RowBox[{"f", "@@", "coords"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\"", 
             ",", "\"\<orth\>\"", ",", "\"\<trig\>\""}], "}"}]}], "]"}], "/.", 
         RowBox[{"h", "->", 
          RowBox[{"(", 
           RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], ")"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
       "&"}]}], ")"}], "//.", "cleanupRescaled"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/eps-lap-f.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.883969630654079*^9, 3.883969670252007*^9}, {
  3.88396971402907*^9, 3.8839698175344887`*^9}, {3.883969853922323*^9, 
  3.883969915538435*^9}},
 CellLabel->
  "In[674]:=",ExpressionUUID->"931d2ffe-c57a-4816-aed7-ea27cc49f9af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Laplacian", "Subsection",
 CellChangeTimes->{{3.883970155740444*^9, 
  3.883970158120055*^9}},ExpressionUUID->"f8a7123f-761e-4a66-abda-\
c2585f45ba8b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"1", "-", "\[CurlyEpsilon]"}]], "//", 
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.883970602630143*^9, 3.883970626149572*^9}},
 CellLabel->
  "In[690]:=",ExpressionUUID->"bfe72868-4fea-41ff-86ed-6026698512b9"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"applyRules", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorContract", "[", 
              RowBox[{
               RowBox[{"grad0", "[", 
                RowBox[{"grad0", "[", "us", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\"", 
              ",", "\"\<orth\>\""}], "}"}]}], "]"}], "/.", 
          RowBox[{"h", "->", 
           RowBox[{"(", 
            RowBox[{"1", "&"}], ")"}]}]}], "//", "Simplify"}], ")"}], "/.", 
       "rescaling"}], "//", 
      RowBox[{
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "j"}], "}"}]}], "]"}], 
       "&"}]}], ")"}], "//.", "cleanupRescaled"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883970548313154*^9, 3.883970598919752*^9}},
 CellLabel->
  "In[691]:=",ExpressionUUID->"8a0265a5-00f1-440b-81eb-b62c47e54023"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"applyRules", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"TensorContract", "[", 
                    RowBox[{
                    RowBox[{"grad0", "[", 
                    RowBox[{"grad0", "[", "us", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[IndentingNewLine]", 
                    "-", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"grad0", "[", 
                    RowBox[{"grad0", "[", 
                    RowBox[{"us", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                   ")"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", 
                    "\"\<h0E\>\"", ",", "\"\<orth\>\""}], "}"}]}], "]"}], "/.", 
                RowBox[{"h", "->", 
                 RowBox[{"(", 
                  RowBox[{"1", "&"}], ")"}]}]}], "//", "Simplify"}], ")"}], "/.",
              "rescaling"}], "//", 
            RowBox[{
             RowBox[{"SeriesCoefficient", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "j"}], "}"}]}], 
              "]"}], "&"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"#", ",", "uordering", ",", "Simplify"}], "]"}], "&"}]}], 
       ")"}], ".", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["\[CurlyEpsilon]", 
         RowBox[{"-", "2"}]], ",", 
        SuperscriptBox["\[CurlyEpsilon]", 
         RowBox[{"-", "1"}]], ",", "1"}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
      "&"}]}], ")"}], "//.", 
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<trig\>\"", "]"}], "]"}]}], "//.", "cleanupRescaled", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{
      RowBox[{"toTeX", "[", 
       RowBox[{"#", ",", 
        RowBox[{"vectorStringsList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<expressions/eps-lap-u.txt\>\"", ",", "#"}], "]"}], "&"}]}],
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.883970181466051*^9, 3.883970260992897*^9}, {
   3.8839703024623623`*^9, 3.883970333360924*^9}, {3.8839703791843233`*^9, 
   3.883970387758724*^9}, {3.8839704266204844`*^9, 3.8839705032708797`*^9}, {
   3.883970697808433*^9, 3.883970698522995*^9}, {3.883970750457398*^9, 
   3.8839707926094913`*^9}, {3.883971020183872*^9, 3.8839710316783953`*^9}, {
   3.8839710678149557`*^9, 3.8839712448247232`*^9}, {3.883971285475396*^9, 
   3.88397130023615*^9}, {3.88397134424743*^9, 3.8839715529199467`*^9}, {
   3.883971764565981*^9, 3.883971794713866*^9}, 3.883971998072318*^9},
 CellLabel->
  "In[721]:=",ExpressionUUID->"eedc1f71-1f3a-43ba-9559-45ebdab1c359"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curl", "Subsection",
 CellChangeTimes->{{3.883969603263369*^9, 3.8839696124721537`*^9}, {
  3.883972192531322*^9, 
  3.883972193112424*^9}},ExpressionUUID->"a801be1f-7468-4999-96c5-\
cbafc30a2766"],

Cell[BoxData[
 RowBox[{
  RowBox[{"curl0", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{
     RowBox[{"tensorRank", "[", "f", "]"}], "==", "1"}]}], "]"}], ":=", 
  RowBox[{"TensorContract", "[", 
   RowBox[{
    RowBox[{"eps", "\[TensorProduct]", 
     RowBox[{"grad0", "[", "f", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.883972195214957*^9, 3.883972244105175*^9}},
 CellLabel->
  "In[722]:=",ExpressionUUID->"40f45ca9-daf4-46ef-b4b2-73168e8bd27a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"applyRules", "[", 
         RowBox[{
          RowBox[{"curl0", "[", "us", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\"", 
            ",", "\"\<trig\>\""}], "}"}]}], "]"}], "/.", 
        RowBox[{"h", "->", 
         RowBox[{"(", 
          RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
       "&"}]}], ")"}], "//.", "cleanupRescaled"}], "//", 
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/eps-curl-u.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.883972247105852*^9, 3.883972377291296*^9}, {
  3.883972514205142*^9, 3.883972516590807*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"8f63d455-4cd1-4749-aca2-a3087e9683ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Curl curl", "Subsection",
 CellChangeTimes->{{3.883972652864472*^9, 
  3.883972654845078*^9}},ExpressionUUID->"22f4b49a-2fa5-41c4-8aa1-\
0cce80348a66"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"applyRules", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"curl0", "[", 
            RowBox[{"curl0", "[", "us", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<gradf20E\>\"", ",", "\"\<dsf20E\>\"", ",", "\"\<h0E\>\"", 
            ",", "\"\<orth\>\""}], "}"}]}], "]"}], "/.", 
        RowBox[{"h", "->", 
         RowBox[{"(", 
          RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
       "&"}]}], "//", "Simplify"}], ")"}], "//.", 
   RowBox[{"rules", "[", 
    RowBox[{"[", "\"\<trig\>\"", "]"}], "]"}]}], "//.", "cleanupRescaled", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{
      RowBox[{"toTeX", "[", 
       RowBox[{"#", ",", 
        RowBox[{"vectorStringsList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<expressions/eps-curl-curl-u.txt\>\"", ",", "#"}], "]"}], 
     "&"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.883972664573084*^9, 3.8839727020186243`*^9}, 
   3.883972741220739*^9, {3.883973747166107*^9, 3.8839737480568457`*^9}, {
   3.883973794530828*^9, 3.8839738309650803`*^9}, {3.883973873290084*^9, 
   3.883973914285297*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"cca3dd70-596e-4b1c-add1-0ac7148cd303"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar time derivative", "Subsection",
 CellChangeTimes->{{3.883975235401289*^9, 
  3.883975239917245*^9}},ExpressionUUID->"a1631788-ee54-4b32-bd54-\
6ae73fa4aea3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"applyRules", "[", 
         RowBox[{
          RowBox[{"dt0", "[", 
           RowBox[{"f", "@@", "coords"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<dtf20E\>\"", ",", "\"\<h0E\>\"", ",", "\"\<trig\>\""}], 
           "}"}]}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "@@", "coords"}], "->", 
            RowBox[{"f", "[", 
             RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]2", ",", "\[Beta]2", ",", "\[Gamma]2"}], 
              "}"}]}], "}"}]}], "]"}], ")"}]}], "/.", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
      "&"}]}], "//", "Simplify"}], ")"}], "//.", "cleanupRescaled", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{
      RowBox[{"toTeX", "[", 
       RowBox[{"#", ",", 
        RowBox[{"vectorStringsList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{"\"\<expressions/eps-dt-u.txt\>\"", ",", "#"}], "]"}], "&"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.883975247289012*^9, 3.883975258837969*^9}},
 CellLabel->
  "In[769]:=",ExpressionUUID->"c33ef566-9bee-4325-aff6-567d73cbb80a"],

Cell[BoxData[
 RowBox[{"rules", "[", 
  RowBox[{"[", "\"\<gradf20E\>\"", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.883975881106504*^9, 3.883975900323007*^9}},
 CellLabel->
  "In[771]:=",ExpressionUUID->"9a698f4a-549c-4888-a11d-905303782555"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector time derivative", "Subsection",
 CellChangeTimes->{{3.883973980814073*^9, 
  3.88397398352544*^9}},ExpressionUUID->"8f8b364f-8cd9-42f2-a975-\
d8c32e2678be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"applyRules", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dt0", "[", "us", "]"}], "-", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"dt0", "[", 
                RowBox[{"us", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<dtf20E\>\"", ",", "\"\<h0E\>\"", ",", "\"\<trig\>\""}], 
             "}"}]}], "]"}], "/.", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "@@", "coords"}], "->", 
              RowBox[{"f", "[", 
               RowBox[{"s", ",", "\[Theta]", ",", "\[Tau]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]2", ",", "\[Beta]2", ",", "\[Gamma]2"}], 
                "}"}]}], "}"}]}], "]"}], ")"}]}], "/.", 
         RowBox[{"h", "->", 
          RowBox[{"(", 
           RowBox[{"1", "&"}], ")"}]}]}], "/.", "rescaling"}], "//", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
        "&"}]}], "//", "Simplify"}], ")"}], "//.", "cleanupRescaled"}], "//", 
   
   RowBox[{
    RowBox[{"toTeX", "[", 
     RowBox[{"#", ",", 
      RowBox[{"vectorStringsList", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<expressions/eps-dt-u.txt\>\"", ",", "#"}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.883973985010035*^9, 3.88397409401716*^9}, {
  3.883974157473145*^9, 3.883974330541202*^9}, {3.883974375616571*^9, 
  3.883974425151577*^9}, {3.8839747824590483`*^9, 3.8839747839306107`*^9}, {
  3.8839750718396063`*^9, 3.8839750865255957`*^9}},
 CellLabel->
  "In[768]:=",ExpressionUUID->"31e878a9-d7c4-4bed-b7a4-0b158c12a450"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1260, 759},
WindowMargins->{{Automatic, 258}, {-825, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
CellProlog:>SelectionMove[
  NextCell[CellStyle -> "Input"], All, Cell],
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"ReverseColor.nb",
ExpressionUUID->"216a5ebf-40e8-404e-81dc-89e7666692ce"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 330, 5, 146, "Title",ExpressionUUID->"2e1e1f32-b3e7-4f78-8ef1-b3e9d5ee5503"],
Cell[755, 22, 1072, 19, 324, "Text",ExpressionUUID->"a884496d-9ba9-419b-b225-2e2beae087b4"],
Cell[1830, 43, 417, 10, 78, "Input",ExpressionUUID->"b1564d7e-0c6f-4514-a7b7-a94d5622f2bf"],
Cell[2250, 55, 392, 8, 80, "Text",ExpressionUUID->"921cd982-67cd-48b5-aba2-04514cc7ca0c"],
Cell[2645, 65, 431, 10, 78, "Input",ExpressionUUID->"e42cac10-fd80-4b2d-bece-7a274c954744"],
Cell[3079, 77, 759, 20, 140, "Input",ExpressionUUID->"1b693d0f-c872-4f72-aa77-375cef25a26a"],
Cell[3841, 99, 730, 21, 81, "Text",ExpressionUUID->"8bbaf7dc-cb10-4d83-abbe-be80520385ec"],
Cell[4574, 122, 1713, 49, 264, "Input",ExpressionUUID->"bde4fad2-65ff-4d33-8910-a8949966331d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6324, 176, 423, 6, 146, "Title",ExpressionUUID->"c6f33c08-f43a-488c-afc0-18bdd2256c92"],
Cell[CellGroupData[{
Cell[6772, 186, 189, 3, 103, "Chapter",ExpressionUUID->"6269c5ce-48c0-45fd-a55a-c7fb526903d1"],
Cell[6964, 191, 195, 3, 49, "Text",ExpressionUUID->"500e6883-8734-41be-8f22-d20ce500f99c"],
Cell[7162, 196, 1455, 39, 88, "Input",ExpressionUUID->"3ff7dbd8-24ef-4905-bea4-058fa7b9ec34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8654, 240, 160, 3, 103, "Chapter",ExpressionUUID->"2b6356ef-76e1-45cc-b357-03aaa7b73a9d"],
Cell[8817, 245, 246, 6, 49, "Text",ExpressionUUID->"841a0af2-0e20-409e-b897-1d16fede48da"],
Cell[9066, 253, 1522, 39, 172, "Input",ExpressionUUID->"a3ad1c98-e6e2-48e0-adec-865f848aae31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10625, 297, 215, 4, 103, "Chapter",ExpressionUUID->"7fd2c975-f77b-40af-a0d4-92de0965e0d6"],
Cell[10843, 303, 226, 5, 49, "Text",ExpressionUUID->"46a027d7-762c-43fe-acef-a274d6b2908a"],
Cell[11072, 310, 1470, 45, 98, "Input",ExpressionUUID->"f96b18d6-ab82-4ec4-a8c7-26d7a438f19b"],
Cell[12545, 357, 296, 9, 73, "Input",ExpressionUUID->"5b53aba6-0f6d-4b81-ac7c-c244c0aa5570"],
Cell[12844, 368, 2054, 50, 207, "Input",ExpressionUUID->"f08d7b06-e801-420b-87b4-d0f9a2770f51"],
Cell[14901, 420, 4170, 114, 331, "Input",ExpressionUUID->"fca8fb55-8e14-4fc3-af60-3ba6c659aef8"],
Cell[19074, 536, 202, 3, 49, "Text",ExpressionUUID->"b3a390bd-2aa4-40ea-969c-4b0157fedf56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19313, 544, 161, 3, 103, "Chapter",ExpressionUUID->"4c7f5fb7-af9a-46f4-b145-9337f1a72fd3"],
Cell[19477, 549, 269, 4, 49, "Text",ExpressionUUID->"e1e5d8aa-2419-4722-a7b0-e5dc74c27468"],
Cell[19749, 555, 1499, 32, 46, "Input",ExpressionUUID->"315e1377-ff8a-41fd-b184-eaf76c259028"],
Cell[21251, 589, 1555, 33, 46, "Input",ExpressionUUID->"df00b410-401a-48da-beb9-657da3eaf177"],
Cell[22809, 624, 190, 3, 49, "Text",ExpressionUUID->"757dcede-47cf-491f-b6c0-2cabe7342f77"],
Cell[23002, 629, 1629, 35, 46, "Input",ExpressionUUID->"3ca1363d-a6dc-4a71-931f-6172309ce470"],
Cell[24634, 666, 271, 6, 49, "Text",ExpressionUUID->"7498a912-4632-412a-a82b-71242dc462e8"],
Cell[24908, 674, 3706, 100, 295, "Input",ExpressionUUID->"06a0c9e6-13e5-45da-98cb-196f3e5132e6"],
Cell[28617, 776, 283, 6, 80, "Text",ExpressionUUID->"a1ad2279-450c-44be-a395-e6115b58f3a4"],
Cell[28903, 784, 4895, 136, 419, "Input",ExpressionUUID->"c61beff9-6eea-4669-a076-c44ed77f6454"],
Cell[33801, 922, 171, 3, 49, "Text",ExpressionUUID->"b2d61aa7-bc9f-4728-a2fe-91f7d8b9fb6f"],
Cell[33975, 927, 1361, 26, 46, "Input",ExpressionUUID->"59a5b122-039c-42d5-8aa3-2a2e672aadd5"],
Cell[35339, 955, 2519, 69, 188, "Input",ExpressionUUID->"b9e70ac2-370f-4717-97cd-f85166dbf6f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37895, 1029, 170, 3, 103, "Chapter",ExpressionUUID->"427a00a2-eac3-4f8e-8123-f78d72220999"],
Cell[38068, 1034, 189, 3, 49, "Text",ExpressionUUID->"204bd57c-d5c8-44dc-bff2-6b8fdeedf456"],
Cell[38260, 1039, 2090, 53, 217, "Input",ExpressionUUID->"5cfb8c2d-2c36-494f-b10c-432b47a0b70e"],
Cell[40353, 1094, 1696, 44, 112, "Input",ExpressionUUID->"d4e1eeda-6239-4485-b48c-64d458304537"],
Cell[42052, 1140, 1711, 50, 157, "Input",ExpressionUUID->"6cca8fa2-6a1e-4a0c-8d83-c6226d1f75b5"],
Cell[43766, 1192, 1403, 41, 129, "Input",ExpressionUUID->"24177bbd-64fc-435a-a089-1511e56d2e9f"],
Cell[45172, 1235, 1484, 40, 157, "Input",ExpressionUUID->"0aaeaf19-fc69-4ff4-ae89-6c573540f7c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46693, 1280, 266, 4, 103, "Chapter",ExpressionUUID->"7fb3a3fb-beaa-4833-a64a-d29f91aadada"],
Cell[46962, 1286, 262, 6, 49, "Text",ExpressionUUID->"64065052-95d1-49a7-b2f2-a4df5a36ff66"],
Cell[47227, 1294, 2815, 65, 140, "Input",ExpressionUUID->"fa076125-35d3-4430-a42f-9f27e3141410"],
Cell[50045, 1361, 3280, 80, 166, "Input",ExpressionUUID->"de2ee178-3320-4a07-9e8a-e5a07a187453"],
Cell[53328, 1443, 2062, 41, 126, "Input",ExpressionUUID->"5582647b-a66a-4c1b-a0b8-28d3072105e9"],
Cell[55393, 1486, 1925, 37, 63, "Input",ExpressionUUID->"019cc045-f1fa-4ed4-89fa-e02a692396f9"],
Cell[57321, 1525, 157, 3, 49, "Text",ExpressionUUID->"3bd68f2d-f219-46ce-b4e6-fef2e25ef988"],
Cell[57481, 1530, 2051, 55, 188, "Input",ExpressionUUID->"b9526347-554b-4df5-9d75-3c9cb0f51047"],
Cell[59535, 1587, 1832, 46, 157, "Input",ExpressionUUID->"2108156a-a0e1-4978-b406-af6474f34d45"],
Cell[61370, 1635, 910, 26, 63, "Input",ExpressionUUID->"a569aa6b-4321-4732-b124-3ecd22eb1176"],
Cell[62283, 1663, 762, 21, 63, "Input",ExpressionUUID->"3105fc13-e4c6-4c97-bdb5-2719f2a443be"],
Cell[63048, 1686, 300, 7, 49, "Text",ExpressionUUID->"9daf41dc-4a03-49c9-b493-3bc06772e92d"],
Cell[63351, 1695, 233, 4, 46, "Input",ExpressionUUID->"d4bd1942-9410-4238-b305-a0736e8f6cdd"],
Cell[63587, 1701, 1752, 41, 95, "Input",ExpressionUUID->"d5b4d673-4df3-449b-be59-8eb16a72b7e9"],
Cell[65342, 1744, 1752, 41, 95, "Input",ExpressionUUID->"0dbe8738-8dc8-4ae6-b2ff-3c089e2d6514"],
Cell[67097, 1787, 156, 3, 49, "Text",ExpressionUUID->"9448e175-daab-4d31-8857-ba58d74e87da"],
Cell[67256, 1792, 1963, 47, 95, "Input",ExpressionUUID->"0d9fd189-3341-40e4-ae8c-3e4723a33684"],
Cell[69222, 1841, 165, 3, 49, "Text",ExpressionUUID->"6f5c1dab-f0a6-41cd-a3aa-a8c91ae41b68"],
Cell[69390, 1846, 1322, 38, 95, "Input",ExpressionUUID->"180ea80d-a070-4180-96a2-ad871fc32ecc"],
Cell[70715, 1886, 161, 3, 49, "Text",ExpressionUUID->"76489500-e9b6-4a9d-9ead-09821a4223bc"],
Cell[70879, 1891, 3685, 111, 374, "Input",ExpressionUUID->"7430f6de-8cec-4397-a3de-bbca8d61196d"],
Cell[74567, 2004, 1578, 38, 91, "Input",ExpressionUUID->"1da01659-a405-441c-9d77-18af4541a128"],
Cell[76148, 2044, 694, 20, 46, "Input",ExpressionUUID->"605a9bcd-560f-473f-93c4-b1504696e2c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76879, 2069, 172, 3, 103, "Chapter",ExpressionUUID->"1ee5698f-2e77-4c22-a8ce-46cd6b6414d6"],
Cell[77054, 2074, 551, 16, 47, "Input",ExpressionUUID->"5ea1a969-b3c2-4ec7-88e1-407f51bf47c2"],
Cell[77608, 2092, 1799, 49, 140, "Input",ExpressionUUID->"7a3fb462-3184-461e-9778-8701492179fc"],
Cell[79410, 2143, 1761, 48, 140, "Input",ExpressionUUID->"71fca987-9a53-49d2-ae4a-7c1a21312ee1"],
Cell[81174, 2193, 1023, 30, 78, "Input",ExpressionUUID->"7e6504b9-6e54-477e-a4fd-053d038a69e4"],
Cell[82200, 2225, 1025, 30, 78, "Input",ExpressionUUID->"af1e362d-e8b7-47cc-a621-f661846519ee"],
Cell[83228, 2257, 1265, 34, 78, "Input",ExpressionUUID->"29f25e11-4194-444b-bbff-cf6ae070f74c"],
Cell[84496, 2293, 914, 27, 63, "Input",ExpressionUUID->"9809e05b-d06a-43cd-b99b-32639d331c8a"],
Cell[85413, 2322, 1497, 41, 157, "Input",ExpressionUUID->"8d6c6301-201f-4f6f-9cfa-b1421746738d"],
Cell[86913, 2365, 1666, 43, 157, "Input",ExpressionUUID->"cdba57bf-6f6e-427e-bb02-88c1e9a8990a"],
Cell[88582, 2410, 718, 19, 95, "Input",ExpressionUUID->"507b40ea-8ba7-4dee-a8fc-03a823a32401"],
Cell[89303, 2431, 831, 24, 95, "Input",ExpressionUUID->"6ec864d2-cc5e-4cb3-b467-e6ac8bd0b55a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90171, 2460, 177, 3, 103, "Chapter",ExpressionUUID->"e350c6e0-6fb5-45f8-aea0-098c72cfda13"],
Cell[90351, 2465, 1345, 37, 126, "Input",ExpressionUUID->"ef7cc9ba-da24-485a-bf31-9b1785706e92"],
Cell[91699, 2504, 1163, 33, 157, "Input",ExpressionUUID->"74778e71-c08a-4411-a091-74b33c6bead5"],
Cell[92865, 2539, 883, 25, 157, "Input",ExpressionUUID->"600d9ddd-876b-4dbd-866f-182576bfe4c4"],
Cell[93751, 2566, 1164, 33, 157, "Input",ExpressionUUID->"b7bae9f3-176f-4e86-8a69-dc2deac33c08"],
Cell[94918, 2601, 1440, 40, 157, "Input",ExpressionUUID->"d1d2fe28-4cb4-4abe-b000-1e4520d9171f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96407, 2647, 170, 3, 146, "Title",ExpressionUUID->"834f35ea-2eb7-4440-9dc8-9c67f76f0c5d"],
Cell[CellGroupData[{
Cell[96602, 2654, 155, 3, 103, "Chapter",ExpressionUUID->"ed29a657-f053-4cd1-975f-29270a2d5c7a"],
Cell[96760, 2659, 171, 3, 49, "Text",ExpressionUUID->"9180b5c3-fda1-4787-825b-c2b602e63f8f"],
Cell[96934, 2664, 714, 21, 95, "Input",ExpressionUUID->"3ce24e00-96da-40ca-bb5a-83886a682ca9"],
Cell[97651, 2687, 192, 3, 49, "Text",ExpressionUUID->"7c454260-6b0a-4a17-9bd6-8c1db839d466"],
Cell[97846, 2692, 2619, 78, 202, "Input",ExpressionUUID->"adba6f3d-da35-4dae-9386-cf3e970d56f7"],
Cell[100468, 2772, 1175, 36, 109, "Input",ExpressionUUID->"ac355aca-ea72-4941-bd3b-66a1d62c8439"],
Cell[101646, 2810, 201, 3, 49, "Text",ExpressionUUID->"edef075a-0001-44c8-aa80-4e03be4670b5"],
Cell[101850, 2815, 210, 4, 46, "Input",ExpressionUUID->"d9dbd370-0175-4568-924a-85087e4aa7b7"],
Cell[102063, 2821, 3555, 107, 233, "Input",ExpressionUUID->"6d2e4523-ccd8-4fbf-942b-45269cccbb48"],
Cell[105621, 2930, 3410, 105, 233, "Input",ExpressionUUID->"cb25be5d-2668-4d09-a966-25023fb5cbac"],
Cell[109034, 3037, 394, 11, 46, "Input",ExpressionUUID->"cc114711-ec4e-4c3f-aab7-390f47f90441"],
Cell[109431, 3050, 471, 12, 63, "Input",ExpressionUUID->"10a15a0e-c617-4330-978f-6de1b5b4912d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109939, 3067, 174, 3, 103, "Chapter",ExpressionUUID->"7228f487-d079-4165-8cff-00782f5d73dc"],
Cell[110116, 3072, 1027, 31, 95, "Input",ExpressionUUID->"fb908e52-cb05-4cf4-8884-a5f73dcafd6a"],
Cell[111146, 3105, 1074, 32, 95, "Input",ExpressionUUID->"7db9f0f4-b947-4d92-9b19-b7b9d10777c7"],
Cell[112223, 3139, 739, 20, 95, "Input",ExpressionUUID->"8af3a6db-36ac-4d6b-a49b-f1ba7e207c70"],
Cell[112965, 3161, 2663, 69, 159, "Input",ExpressionUUID->"2656d42c-4204-4ce6-9461-1364f74f6950"],
Cell[115631, 3232, 1364, 40, 157, "Input",ExpressionUUID->"1bdae79b-ce62-486c-a50b-e9a7f339f207"],
Cell[116998, 3274, 1753, 46, 109, "Input",ExpressionUUID->"91a7833c-cd6d-428d-b2e6-4ac324a6c51e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118788, 3325, 588, 19, 104, "Chapter",ExpressionUUID->"5b7e8192-aa2b-40a8-8a7b-db6301b86a06"],
Cell[119379, 3346, 7324, 192, 861, "Input",ExpressionUUID->"4a5f0ebf-c05e-45eb-a391-2deb90a0a9a1"],
Cell[126706, 3540, 1199, 31, 120, "Input",ExpressionUUID->"195826a5-38c1-4d03-8dac-08e806eb4294"],
Cell[127908, 3573, 5371, 121, 916, "Input",ExpressionUUID->"659b43ad-2ed9-4243-bcf7-3cfd7c418726"],
Cell[133282, 3696, 4092, 112, 419, "Input",ExpressionUUID->"a9e880dc-cc0c-4bd9-acc7-78f54b7619f6"],
Cell[CellGroupData[{
Cell[137399, 3812, 604, 20, 81, "Subsection",ExpressionUUID->"9b237b80-4b40-47c8-bdbb-a7dfb93140eb"],
Cell[138006, 3834, 229, 6, 49, "Text",ExpressionUUID->"4f7c01c5-570c-420a-b481-fc9b0b83d455"],
Cell[138238, 3842, 6555, 203, 558, "Input",ExpressionUUID->"e95f998e-37ee-44fa-8704-a42ec544ea82"],
Cell[144796, 4047, 196, 3, 49, "Text",ExpressionUUID->"a00b40c5-f251-4c6a-ab3a-2307fda98e9d"],
Cell[144995, 4052, 1214, 35, 78, "Input",ExpressionUUID->"111a3eda-66d9-4b22-a934-561a30c60eaf"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146258, 4093, 178, 3, 103, "Chapter",ExpressionUUID->"a64a53e3-b20e-4767-a04f-0a61cba6f22b"],
Cell[146439, 4098, 201, 3, 62, "Text",ExpressionUUID->"c2da3286-1bff-458c-b508-3ba8ecaa74eb"],
Cell[146643, 4103, 484, 12, 46, "Input",ExpressionUUID->"14b72bc8-f610-41e7-b810-d0b3b8b62583"],
Cell[CellGroupData[{
Cell[147152, 4119, 165, 3, 81, "Subsection",ExpressionUUID->"eafe127d-9050-4b0d-bb0d-da786b9fe74d"],
Cell[147320, 4124, 277, 7, 46, "Input",ExpressionUUID->"afb0db13-e758-412e-8fb6-1c5732dd87d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147634, 4136, 169, 3, 81, "Subsection",ExpressionUUID->"8a8e9c80-ca15-43a2-9e00-05c7c31b6b22"],
Cell[147806, 4141, 269, 6, 46, "Input",ExpressionUUID->"fe1f7f48-282c-4048-926c-6e04ccd66086"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148112, 4152, 165, 3, 81, "Subsection",ExpressionUUID->"77d9002b-8545-4112-b4e9-737d94db8fb6"],
Cell[148280, 4157, 370, 10, 46, "Input",ExpressionUUID->"3c0c191e-0631-4734-8717-a49273048604"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148687, 4172, 161, 3, 81, "Subsection",ExpressionUUID->"9599539a-e515-491e-b18b-241f88460d48"],
Cell[148851, 4177, 515, 15, 46, "Input",ExpressionUUID->"64eda5f6-7de8-4498-95fe-5f73a8499a77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149403, 4197, 166, 3, 81, "Subsection",ExpressionUUID->"1138ab8c-d5c1-4343-a42d-d45e4caec251"],
Cell[149572, 4202, 1180, 33, 109, "Input",ExpressionUUID->"b9916b3a-b648-406c-9776-6a447f57ed77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150789, 4240, 196, 3, 81, "Subsection",ExpressionUUID->"6599d6ab-5ef2-46fe-bc70-3b0906299206"],
Cell[150988, 4245, 526, 15, 63, "Input",ExpressionUUID->"29858c63-d768-414a-aaae-1e09540439a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151551, 4265, 243, 4, 81, "Subsection",ExpressionUUID->"7c66db1b-e406-4a18-b4c5-335e4818fa46"],
Cell[151797, 4271, 575, 16, 63, "Input",ExpressionUUID->"8d01f408-727f-4b08-b80c-f4d8c7cfd749"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152409, 4292, 198, 3, 81, "Subsection",ExpressionUUID->"43102865-0852-43f9-8263-7901db56976d"],
Cell[152610, 4297, 273, 6, 63, "Input",ExpressionUUID->"5bf02cdf-22fb-4962-a136-91d5ddf43957"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152920, 4308, 195, 3, 81, "Subsection",ExpressionUUID->"619f9bff-267b-4f5b-920d-c7d19db2fa22"],
Cell[153118, 4313, 275, 6, 63, "Input",ExpressionUUID->"689f7a87-88fa-47c3-82c5-66734c80adff"],
Cell[153396, 4321, 859, 23, 73, "Input",ExpressionUUID->"9b32c88d-5c66-4b83-8b04-7e4576d943b5"],
Cell[154258, 4346, 838, 22, 72, "Input",ExpressionUUID->"3dc023f2-08f3-4b9f-a06a-e3d87e2154cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155133, 4373, 185, 3, 81, "Subsection",ExpressionUUID->"384f5fec-279c-42b9-9be4-efc7c6f23cca"],
Cell[155321, 4378, 266, 6, 46, "Input",ExpressionUUID->"55031bac-a050-4832-b6d9-9649072ba2ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155624, 4389, 183, 3, 81, "Subsection",ExpressionUUID->"931effb2-67d6-42e1-91b3-e7e9e1fa8deb"],
Cell[155810, 4394, 468, 14, 46, "Input",ExpressionUUID->"4f70b65c-1434-496f-a1c6-a803881c91a3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[156327, 4414, 160, 3, 103, "Chapter",ExpressionUUID->"3188071f-e9bb-4851-9d99-bb7458570b01"],
Cell[156490, 4419, 603, 13, 46, "Input",ExpressionUUID->"37f1d0a1-beff-4a86-b659-2b2716bc6487"],
Cell[157096, 4434, 865, 22, 157, "Input",ExpressionUUID->"f80f13ab-d63c-4f23-b2c7-f7d9063057af"],
Cell[157964, 4458, 5183, 143, 456, "Input",ExpressionUUID->"9f882a8b-f789-4d11-9345-034621cf3377"],
Cell[163150, 4603, 746, 21, 63, "Input",ExpressionUUID->"a389002c-56eb-4c8f-8737-41ae109d6912"],
Cell[CellGroupData[{
Cell[163921, 4628, 216, 4, 81, "Subsection",ExpressionUUID->"d56ff32e-517d-46f2-a3a7-bd5264cdf6cd"],
Cell[164140, 4634, 755, 22, 95, "Input",ExpressionUUID->"53597146-ced9-4f9f-8733-131bcc13b1e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164932, 4661, 165, 3, 81, "Subsection",ExpressionUUID->"c9900710-dc7d-409f-afc8-9ef5c2c39344"],
Cell[165100, 4666, 1470, 41, 126, "Input",ExpressionUUID->"c150067f-b696-4a0f-97a2-5ceec036e7cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166607, 4712, 158, 3, 81, "Subsection",ExpressionUUID->"617e96ef-4e01-4578-abd1-7babda161f05"],
Cell[166768, 4717, 1315, 39, 126, "Input",ExpressionUUID->"d5aaa4cc-ca54-4e23-a224-74ab5fb6f10b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168120, 4761, 166, 3, 81, "Subsection",ExpressionUUID->"9f322cd9-a8cc-4d13-b108-7e038d7f5c0e"],
Cell[168289, 4766, 1468, 41, 126, "Input",ExpressionUUID->"931d2ffe-c57a-4816-aed7-ea27cc49f9af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169794, 4812, 164, 3, 81, "Subsection",ExpressionUUID->"f8a7123f-761e-4a66-abda-c2585f45ba8b"],
Cell[169961, 4817, 427, 12, 86, "Input",ExpressionUUID->"bfe72868-4fea-41ff-86ed-6026698512b9"],
Cell[170391, 4831, 1452, 41, 157, "Input",ExpressionUUID->"8a0265a5-00f1-440b-81eb-b62c47e54023"],
Cell[171846, 4874, 3676, 93, 256, "Input",ExpressionUUID->"eedc1f71-1f3a-43ba-9559-45ebdab1c359"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175559, 4972, 203, 4, 81, "Subsection",ExpressionUUID->"a801be1f-7468-4999-96c5-cbafc30a2766"],
Cell[175765, 4978, 626, 18, 46, "Input",ExpressionUUID->"40f45ca9-daf4-46ef-b4b2-73168e8bd27a"],
Cell[176394, 4998, 1237, 36, 109, "Input",ExpressionUUID->"8f63d455-4cd1-4749-aca2-a3087e9683ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177668, 5039, 157, 3, 81, "Subsection",ExpressionUUID->"22f4b49a-2fa5-41c4-8aa1-0cce80348a66"],
Cell[177828, 5044, 1611, 45, 109, "Input",ExpressionUUID->"cca3dd70-596e-4b1c-add1-0ac7148cd303"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179476, 5094, 170, 3, 81, "Subsection",ExpressionUUID->"a1631788-ee54-4b32-bd54-6ae73fa4aea3"],
Cell[179649, 5099, 1732, 51, 140, "Input",ExpressionUUID->"c33ef566-9bee-4325-aff6-567d73cbb80a"],
Cell[181384, 5152, 245, 5, 46, "Input",ExpressionUUID->"9a698f4a-549c-4888-a11d-905303782555"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181666, 5162, 169, 3, 81, "Subsection",ExpressionUUID->"8f8b364f-8cd9-42f2-a975-d8c32e2678be"],
Cell[181838, 5167, 2233, 61, 140, "Input",ExpressionUUID->"31e878a9-d7c4-4bed-b7a4-0b158c12a450"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

